<div class="apidocDiv">
<style>
/*csslint
*/
.apidocDiv {
    background: #fff;
    font-family: Arial, Helvetica, sans-serif;
}
.apidocDiv a[href] {
    color: #33f;
    font-weight: bold;
    text-decoration: none;
}
.apidocDiv a[href]:hover {
    text-decoration: underline;
}
.apidocCodeCommentSpan {
    background: #bbf;
    color: #000;
    display: block;
}
.apidocCodeKeywordSpan {
    color: #d00;
    font-weight: bold;
}
.apidocCodePre {
    background: #eef;
    border: 1px solid;
    color: #777;
    padding: 5px;
    white-space: pre-wrap;
}
.apidocFooterDiv {
    margin-top: 20px;
    text-align: center;
}
.apidocModuleLi {
    margin-top: 10px;
}
.apidocSectionDiv {
    border-top: 1px solid;
    margin-top: 20px;
}
.apidocSignatureSpan {
    color: #777;
    font-weight: bold;
}
</style>
<h1>api documentation for
    <a

        href="https://github.com/rzcoder/node-rsa"

    >node-rsa (v0.4.2)</a>
</h1>
<h4>Node.js RSA library</h4>
<div class="apidocSectionDiv"><a
    href="#apidoc.tableOfContents"
    id="apidoc.tableOfContents"
><h1>table of contents</h1></a><ol>

    <li class="apidocModuleLi"><a href="#apidoc.module.node-rsa">module node-rsa</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.node-rsa.node-rsa">
            function <span class="apidocSignatureSpan"></span>node-rsa
            <span class="apidocSignatureSpan">(key, format, options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.node-rsa.jsbn">
            function <span class="apidocSignatureSpan">node-rsa.</span>jsbn
            <span class="apidocSignatureSpan">(a, b)</span>
            </a>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">node-rsa.</span>components</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">node-rsa.</span>encryptEngines</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">node-rsa.</span>formats</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">node-rsa.</span>jsbn.prototype</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">node-rsa.</span>oaep</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">node-rsa.</span>pkcs1</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">node-rsa.</span>pkcs8</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">node-rsa.</span>pss</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">node-rsa.</span>rsa</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">node-rsa.</span>schemes</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">node-rsa.</span>utils</span>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.node-rsa.components">module node-rsa.components</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.node-rsa.components.autoImport">
            function <span class="apidocSignatureSpan">node-rsa.components.</span>autoImport
            <span class="apidocSignatureSpan">(key, data)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.node-rsa.components.privateExport">
            function <span class="apidocSignatureSpan">node-rsa.components.</span>privateExport
            <span class="apidocSignatureSpan">(key, options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.node-rsa.components.privateImport">
            function <span class="apidocSignatureSpan">node-rsa.components.</span>privateImport
            <span class="apidocSignatureSpan">(key, data, options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.node-rsa.components.publicExport">
            function <span class="apidocSignatureSpan">node-rsa.components.</span>publicExport
            <span class="apidocSignatureSpan">(key, options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.node-rsa.components.publicImport">
            function <span class="apidocSignatureSpan">node-rsa.components.</span>publicImport
            <span class="apidocSignatureSpan">(key, data, options)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.node-rsa.encryptEngines">module node-rsa.encryptEngines</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.node-rsa.encryptEngines.getEngine">
            function <span class="apidocSignatureSpan">node-rsa.encryptEngines.</span>getEngine
            <span class="apidocSignatureSpan">(keyPair, options)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.node-rsa.formats">module node-rsa.formats</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.node-rsa.formats.detectAndExport">
            function <span class="apidocSignatureSpan">node-rsa.formats.</span>detectAndExport
            <span class="apidocSignatureSpan">(key, format)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.node-rsa.formats.detectAndImport">
            function <span class="apidocSignatureSpan">node-rsa.formats.</span>detectAndImport
            <span class="apidocSignatureSpan">(key, data, format)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.node-rsa.formats.isPrivateExport">
            function <span class="apidocSignatureSpan">node-rsa.formats.</span>isPrivateExport
            <span class="apidocSignatureSpan">(format)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.node-rsa.formats.isPrivateImport">
            function <span class="apidocSignatureSpan">node-rsa.formats.</span>isPrivateImport
            <span class="apidocSignatureSpan">(format)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.node-rsa.formats.isPublicExport">
            function <span class="apidocSignatureSpan">node-rsa.formats.</span>isPublicExport
            <span class="apidocSignatureSpan">(format)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.node-rsa.formats.isPublicImport">
            function <span class="apidocSignatureSpan">node-rsa.formats.</span>isPublicImport
            <span class="apidocSignatureSpan">(format)</span>
            </a>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">node-rsa.formats.</span>components</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">node-rsa.formats.</span>pkcs1</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">node-rsa.formats.</span>pkcs8</span>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.node-rsa.jsbn">module node-rsa.jsbn</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.node-rsa.jsbn.jsbn">
            function <span class="apidocSignatureSpan">node-rsa.</span>jsbn
            <span class="apidocSignatureSpan">(a, b)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.node-rsa.jsbn.int2char">
            function <span class="apidocSignatureSpan">node-rsa.jsbn.</span>int2char
            <span class="apidocSignatureSpan">(n)</span>
            </a>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">node-rsa.jsbn.</span>ONE</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">node-rsa.jsbn.</span>ZERO</span>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.node-rsa.jsbn.prototype">module node-rsa.jsbn.prototype</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.node-rsa.jsbn.prototype.abs">
            function <span class="apidocSignatureSpan">node-rsa.jsbn.prototype.</span>abs
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.node-rsa.jsbn.prototype.add">
            function <span class="apidocSignatureSpan">node-rsa.jsbn.prototype.</span>add
            <span class="apidocSignatureSpan">(a)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.node-rsa.jsbn.prototype.addTo">
            function <span class="apidocSignatureSpan">node-rsa.jsbn.prototype.</span>addTo
            <span class="apidocSignatureSpan">(a, r)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.node-rsa.jsbn.prototype.am">
            function <span class="apidocSignatureSpan">node-rsa.jsbn.prototype.</span>am
            <span class="apidocSignatureSpan">(i, x, w, j, c, n)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.node-rsa.jsbn.prototype.and">
            function <span class="apidocSignatureSpan">node-rsa.jsbn.prototype.</span>and
            <span class="apidocSignatureSpan">(a)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.node-rsa.jsbn.prototype.andNot">
            function <span class="apidocSignatureSpan">node-rsa.jsbn.prototype.</span>andNot
            <span class="apidocSignatureSpan">(a)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.node-rsa.jsbn.prototype.bitCount">
            function <span class="apidocSignatureSpan">node-rsa.jsbn.prototype.</span>bitCount
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.node-rsa.jsbn.prototype.bitLength">
            function <span class="apidocSignatureSpan">node-rsa.jsbn.prototype.</span>bitLength
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.node-rsa.jsbn.prototype.bitwiseTo">
            function <span class="apidocSignatureSpan">node-rsa.jsbn.prototype.</span>bitwiseTo
            <span class="apidocSignatureSpan">(a, op, r)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.node-rsa.jsbn.prototype.byteValue">
            function <span class="apidocSignatureSpan">node-rsa.jsbn.prototype.</span>byteValue
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.node-rsa.jsbn.prototype.changeBit">
            function <span class="apidocSignatureSpan">node-rsa.jsbn.prototype.</span>changeBit
            <span class="apidocSignatureSpan">(n, op)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.node-rsa.jsbn.prototype.chunkSize">
            function <span class="apidocSignatureSpan">node-rsa.jsbn.prototype.</span>chunkSize
            <span class="apidocSignatureSpan">(r)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.node-rsa.jsbn.prototype.clamp">
            function <span class="apidocSignatureSpan">node-rsa.jsbn.prototype.</span>clamp
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.node-rsa.jsbn.prototype.clearBit">
            function <span class="apidocSignatureSpan">node-rsa.jsbn.prototype.</span>clearBit
            <span class="apidocSignatureSpan">(n)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.node-rsa.jsbn.prototype.clone">
            function <span class="apidocSignatureSpan">node-rsa.jsbn.prototype.</span>clone
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.node-rsa.jsbn.prototype.compareTo">
            function <span class="apidocSignatureSpan">node-rsa.jsbn.prototype.</span>compareTo
            <span class="apidocSignatureSpan">(a)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.node-rsa.jsbn.prototype.copyTo">
            function <span class="apidocSignatureSpan">node-rsa.jsbn.prototype.</span>copyTo
            <span class="apidocSignatureSpan">(r)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.node-rsa.jsbn.prototype.dAddOffset">
            function <span class="apidocSignatureSpan">node-rsa.jsbn.prototype.</span>dAddOffset
            <span class="apidocSignatureSpan">(n, w)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.node-rsa.jsbn.prototype.dMultiply">
            function <span class="apidocSignatureSpan">node-rsa.jsbn.prototype.</span>dMultiply
            <span class="apidocSignatureSpan">(n)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.node-rsa.jsbn.prototype.divRemTo">
            function <span class="apidocSignatureSpan">node-rsa.jsbn.prototype.</span>divRemTo
            <span class="apidocSignatureSpan">(m, q, r)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.node-rsa.jsbn.prototype.divide">
            function <span class="apidocSignatureSpan">node-rsa.jsbn.prototype.</span>divide
            <span class="apidocSignatureSpan">(a)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.node-rsa.jsbn.prototype.divideAndRemainder">
            function <span class="apidocSignatureSpan">node-rsa.jsbn.prototype.</span>divideAndRemainder
            <span class="apidocSignatureSpan">(a)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.node-rsa.jsbn.prototype.dlShiftTo">
            function <span class="apidocSignatureSpan">node-rsa.jsbn.prototype.</span>dlShiftTo
            <span class="apidocSignatureSpan">(n, r)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.node-rsa.jsbn.prototype.drShiftTo">
            function <span class="apidocSignatureSpan">node-rsa.jsbn.prototype.</span>drShiftTo
            <span class="apidocSignatureSpan">(n, r)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.node-rsa.jsbn.prototype.equals">
            function <span class="apidocSignatureSpan">node-rsa.jsbn.prototype.</span>equals
            <span class="apidocSignatureSpan">(a)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.node-rsa.jsbn.prototype.exp">
            function <span class="apidocSignatureSpan">node-rsa.jsbn.prototype.</span>exp
            <span class="apidocSignatureSpan">(e, z)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.node-rsa.jsbn.prototype.flipBit">
            function <span class="apidocSignatureSpan">node-rsa.jsbn.prototype.</span>flipBit
            <span class="apidocSignatureSpan">(n)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.node-rsa.jsbn.prototype.fromBuffer">
            function <span class="apidocSignatureSpan">node-rsa.jsbn.prototype.</span>fromBuffer
            <span class="apidocSignatureSpan">(a)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.node-rsa.jsbn.prototype.fromByteArray">
            function <span class="apidocSignatureSpan">node-rsa.jsbn.prototype.</span>fromByteArray
            <span class="apidocSignatureSpan">(a, unsigned)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.node-rsa.jsbn.prototype.fromInt">
            function <span class="apidocSignatureSpan">node-rsa.jsbn.prototype.</span>fromInt
            <span class="apidocSignatureSpan">(x)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.node-rsa.jsbn.prototype.fromNumber">
            function <span class="apidocSignatureSpan">node-rsa.jsbn.prototype.</span>fromNumber
            <span class="apidocSignatureSpan">(a, b)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.node-rsa.jsbn.prototype.fromRadix">
            function <span class="apidocSignatureSpan">node-rsa.jsbn.prototype.</span>fromRadix
            <span class="apidocSignatureSpan">(s, b)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.node-rsa.jsbn.prototype.fromString">
            function <span class="apidocSignatureSpan">node-rsa.jsbn.prototype.</span>fromString
            <span class="apidocSignatureSpan">(data, radix, unsigned)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.node-rsa.jsbn.prototype.gcd">
            function <span class="apidocSignatureSpan">node-rsa.jsbn.prototype.</span>gcd
            <span class="apidocSignatureSpan">(a)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.node-rsa.jsbn.prototype.getLowestSetBit">
            function <span class="apidocSignatureSpan">node-rsa.jsbn.prototype.</span>getLowestSetBit
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.node-rsa.jsbn.prototype.intValue">
            function <span class="apidocSignatureSpan">node-rsa.jsbn.prototype.</span>intValue
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.node-rsa.jsbn.prototype.invDigit">
            function <span class="apidocSignatureSpan">node-rsa.jsbn.prototype.</span>invDigit
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.node-rsa.jsbn.prototype.isEven">
            function <span class="apidocSignatureSpan">node-rsa.jsbn.prototype.</span>isEven
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.node-rsa.jsbn.prototype.isProbablePrime">
            function <span class="apidocSignatureSpan">node-rsa.jsbn.prototype.</span>isProbablePrime
            <span class="apidocSignatureSpan">(t)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.node-rsa.jsbn.prototype.lShiftTo">
            function <span class="apidocSignatureSpan">node-rsa.jsbn.prototype.</span>lShiftTo
            <span class="apidocSignatureSpan">(n, r)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.node-rsa.jsbn.prototype.max">
            function <span class="apidocSignatureSpan">node-rsa.jsbn.prototype.</span>max
            <span class="apidocSignatureSpan">(a)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.node-rsa.jsbn.prototype.millerRabin">
            function <span class="apidocSignatureSpan">node-rsa.jsbn.prototype.</span>millerRabin
            <span class="apidocSignatureSpan">(t)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.node-rsa.jsbn.prototype.min">
            function <span class="apidocSignatureSpan">node-rsa.jsbn.prototype.</span>min
            <span class="apidocSignatureSpan">(a)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.node-rsa.jsbn.prototype.mod">
            function <span class="apidocSignatureSpan">node-rsa.jsbn.prototype.</span>mod
            <span class="apidocSignatureSpan">(a)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.node-rsa.jsbn.prototype.modInt">
            function <span class="apidocSignatureSpan">node-rsa.jsbn.prototype.</span>modInt
            <span class="apidocSignatureSpan">(n)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.node-rsa.jsbn.prototype.modInverse">
            function <span class="apidocSignatureSpan">node-rsa.jsbn.prototype.</span>modInverse
            <span class="apidocSignatureSpan">(m)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.node-rsa.jsbn.prototype.modPow">
            function <span class="apidocSignatureSpan">node-rsa.jsbn.prototype.</span>modPow
            <span class="apidocSignatureSpan">(e, m)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.node-rsa.jsbn.prototype.modPowInt">
            function <span class="apidocSignatureSpan">node-rsa.jsbn.prototype.</span>modPowInt
            <span class="apidocSignatureSpan">(e, m)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.node-rsa.jsbn.prototype.multiply">
            function <span class="apidocSignatureSpan">node-rsa.jsbn.prototype.</span>multiply
            <span class="apidocSignatureSpan">(a)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.node-rsa.jsbn.prototype.multiplyLowerTo">
            function <span class="apidocSignatureSpan">node-rsa.jsbn.prototype.</span>multiplyLowerTo
            <span class="apidocSignatureSpan">(a, n, r)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.node-rsa.jsbn.prototype.multiplyTo">
            function <span class="apidocSignatureSpan">node-rsa.jsbn.prototype.</span>multiplyTo
            <span class="apidocSignatureSpan">(a, r)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.node-rsa.jsbn.prototype.multiplyUpperTo">
            function <span class="apidocSignatureSpan">node-rsa.jsbn.prototype.</span>multiplyUpperTo
            <span class="apidocSignatureSpan">(a, n, r)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.node-rsa.jsbn.prototype.negate">
            function <span class="apidocSignatureSpan">node-rsa.jsbn.prototype.</span>negate
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.node-rsa.jsbn.prototype.not">
            function <span class="apidocSignatureSpan">node-rsa.jsbn.prototype.</span>not
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.node-rsa.jsbn.prototype.or">
            function <span class="apidocSignatureSpan">node-rsa.jsbn.prototype.</span>or
            <span class="apidocSignatureSpan">(a)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.node-rsa.jsbn.prototype.pow">
            function <span class="apidocSignatureSpan">node-rsa.jsbn.prototype.</span>pow
            <span class="apidocSignatureSpan">(e)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.node-rsa.jsbn.prototype.rShiftTo">
            function <span class="apidocSignatureSpan">node-rsa.jsbn.prototype.</span>rShiftTo
            <span class="apidocSignatureSpan">(n, r)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.node-rsa.jsbn.prototype.remainder">
            function <span class="apidocSignatureSpan">node-rsa.jsbn.prototype.</span>remainder
            <span class="apidocSignatureSpan">(a)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.node-rsa.jsbn.prototype.setBit">
            function <span class="apidocSignatureSpan">node-rsa.jsbn.prototype.</span>setBit
            <span class="apidocSignatureSpan">(n)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.node-rsa.jsbn.prototype.shiftLeft">
            function <span class="apidocSignatureSpan">node-rsa.jsbn.prototype.</span>shiftLeft
            <span class="apidocSignatureSpan">(n)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.node-rsa.jsbn.prototype.shiftRight">
            function <span class="apidocSignatureSpan">node-rsa.jsbn.prototype.</span>shiftRight
            <span class="apidocSignatureSpan">(n)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.node-rsa.jsbn.prototype.shortValue">
            function <span class="apidocSignatureSpan">node-rsa.jsbn.prototype.</span>shortValue
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.node-rsa.jsbn.prototype.signum">
            function <span class="apidocSignatureSpan">node-rsa.jsbn.prototype.</span>signum
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.node-rsa.jsbn.prototype.square">
            function <span class="apidocSignatureSpan">node-rsa.jsbn.prototype.</span>square
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.node-rsa.jsbn.prototype.squareTo">
            function <span class="apidocSignatureSpan">node-rsa.jsbn.prototype.</span>squareTo
            <span class="apidocSignatureSpan">(r)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.node-rsa.jsbn.prototype.subTo">
            function <span class="apidocSignatureSpan">node-rsa.jsbn.prototype.</span>subTo
            <span class="apidocSignatureSpan">(a, r)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.node-rsa.jsbn.prototype.subtract">
            function <span class="apidocSignatureSpan">node-rsa.jsbn.prototype.</span>subtract
            <span class="apidocSignatureSpan">(a)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.node-rsa.jsbn.prototype.testBit">
            function <span class="apidocSignatureSpan">node-rsa.jsbn.prototype.</span>testBit
            <span class="apidocSignatureSpan">(n)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.node-rsa.jsbn.prototype.toBuffer">
            function <span class="apidocSignatureSpan">node-rsa.jsbn.prototype.</span>toBuffer
            <span class="apidocSignatureSpan">(trimOrSize)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.node-rsa.jsbn.prototype.toByteArray">
            function <span class="apidocSignatureSpan">node-rsa.jsbn.prototype.</span>toByteArray
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.node-rsa.jsbn.prototype.toRadix">
            function <span class="apidocSignatureSpan">node-rsa.jsbn.prototype.</span>toRadix
            <span class="apidocSignatureSpan">(b)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.node-rsa.jsbn.prototype.toString">
            function <span class="apidocSignatureSpan">node-rsa.jsbn.prototype.</span>toString
            <span class="apidocSignatureSpan">(b)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.node-rsa.jsbn.prototype.xor">
            function <span class="apidocSignatureSpan">node-rsa.jsbn.prototype.</span>xor
            <span class="apidocSignatureSpan">(a)</span>
            </a>

        </li>

        <li>

            <span class="apidocSignatureSpan">number <span class="apidocSignatureSpan">node-rsa.jsbn.prototype.</span>DB</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">number <span class="apidocSignatureSpan">node-rsa.jsbn.prototype.</span>DM</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">number <span class="apidocSignatureSpan">node-rsa.jsbn.prototype.</span>DV</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">number <span class="apidocSignatureSpan">node-rsa.jsbn.prototype.</span>F1</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">number <span class="apidocSignatureSpan">node-rsa.jsbn.prototype.</span>F2</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">number <span class="apidocSignatureSpan">node-rsa.jsbn.prototype.</span>FV</span>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.node-rsa.oaep">module node-rsa.oaep</a><ol>

        <li>

            <span class="apidocSignatureSpan">boolean <span class="apidocSignatureSpan">node-rsa.oaep.</span>isEncryption</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">boolean <span class="apidocSignatureSpan">node-rsa.oaep.</span>isSignature</span>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.node-rsa.oaep.eme_oaep_mgf1">
            function <span class="apidocSignatureSpan">node-rsa.oaep.</span>eme_oaep_mgf1
            <span class="apidocSignatureSpan">(seed, maskLength, hashFunction)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.node-rsa.oaep.makeScheme">
            function <span class="apidocSignatureSpan">node-rsa.oaep.</span>makeScheme
            <span class="apidocSignatureSpan">(key, options)</span>
            </a>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">node-rsa.oaep.</span>digestLength</span>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.node-rsa.pkcs1">module node-rsa.pkcs1</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.node-rsa.pkcs1.autoImport">
            function <span class="apidocSignatureSpan">node-rsa.pkcs1.</span>autoImport
            <span class="apidocSignatureSpan">(key, data)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.node-rsa.pkcs1.privateExport">
            function <span class="apidocSignatureSpan">node-rsa.pkcs1.</span>privateExport
            <span class="apidocSignatureSpan">(key, options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.node-rsa.pkcs1.privateImport">
            function <span class="apidocSignatureSpan">node-rsa.pkcs1.</span>privateImport
            <span class="apidocSignatureSpan">(key, data, options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.node-rsa.pkcs1.publicExport">
            function <span class="apidocSignatureSpan">node-rsa.pkcs1.</span>publicExport
            <span class="apidocSignatureSpan">(key, options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.node-rsa.pkcs1.publicImport">
            function <span class="apidocSignatureSpan">node-rsa.pkcs1.</span>publicImport
            <span class="apidocSignatureSpan">(key, data, options)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.node-rsa.pkcs8">module node-rsa.pkcs8</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.node-rsa.pkcs8.autoImport">
            function <span class="apidocSignatureSpan">node-rsa.pkcs8.</span>autoImport
            <span class="apidocSignatureSpan">(key, data)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.node-rsa.pkcs8.privateExport">
            function <span class="apidocSignatureSpan">node-rsa.pkcs8.</span>privateExport
            <span class="apidocSignatureSpan">(key, options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.node-rsa.pkcs8.privateImport">
            function <span class="apidocSignatureSpan">node-rsa.pkcs8.</span>privateImport
            <span class="apidocSignatureSpan">(key, data, options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.node-rsa.pkcs8.publicExport">
            function <span class="apidocSignatureSpan">node-rsa.pkcs8.</span>publicExport
            <span class="apidocSignatureSpan">(key, options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.node-rsa.pkcs8.publicImport">
            function <span class="apidocSignatureSpan">node-rsa.pkcs8.</span>publicImport
            <span class="apidocSignatureSpan">(key, data, options)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.node-rsa.pss">module node-rsa.pss</a><ol>

        <li>

            <span class="apidocSignatureSpan">boolean <span class="apidocSignatureSpan">node-rsa.pss.</span>isEncryption</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">boolean <span class="apidocSignatureSpan">node-rsa.pss.</span>isSignature</span>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.node-rsa.pss.makeScheme">
            function <span class="apidocSignatureSpan">node-rsa.pss.</span>makeScheme
            <span class="apidocSignatureSpan">(key, options)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.node-rsa.rsa">module node-rsa.rsa</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.node-rsa.rsa.BigInteger">
            function <span class="apidocSignatureSpan">node-rsa.rsa.</span>BigInteger
            <span class="apidocSignatureSpan">(a, b)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.node-rsa.rsa.Key">
            function <span class="apidocSignatureSpan">node-rsa.rsa.</span>Key
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.node-rsa.schemes">module node-rsa.schemes</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.node-rsa.schemes.isEncryption">
            function <span class="apidocSignatureSpan">node-rsa.schemes.</span>isEncryption
            <span class="apidocSignatureSpan">(scheme)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.node-rsa.schemes.isSignature">
            function <span class="apidocSignatureSpan">node-rsa.schemes.</span>isSignature
            <span class="apidocSignatureSpan">(scheme)</span>
            </a>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">node-rsa.schemes.</span>pkcs1</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">node-rsa.schemes.</span>pkcs1_oaep</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">node-rsa.schemes.</span>pss</span>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.node-rsa.utils">module node-rsa.utils</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.node-rsa.utils.detectEnvironment">
            function <span class="apidocSignatureSpan">node-rsa.utils.</span>detectEnvironment
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.node-rsa.utils.get32IntFromBuffer">
            function <span class="apidocSignatureSpan">node-rsa.utils.</span>get32IntFromBuffer
            <span class="apidocSignatureSpan">(buffer, offset)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.node-rsa.utils.linebrk">
            function <span class="apidocSignatureSpan">node-rsa.utils.</span>linebrk
            <span class="apidocSignatureSpan">(str, maxLen)</span>
            </a>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">node-rsa.utils.</span>_</span>

        </li>

    </ol></li>

</ol></div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.node-rsa" id="apidoc.module.node-rsa">module node-rsa</a></h1>


    <h2>
        <a href="#apidoc.element.node-rsa.node-rsa" id="apidoc.element.node-rsa.node-rsa">
        function <span class="apidocSignatureSpan"></span>node-rsa
        <span class="apidocSignatureSpan">(key, format, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function NodeRSA(key, format, options) {
    if (!(this instanceof NodeRSA)) {
        return new NodeRSA(key, format, options);
    }

    if (_.isObject(format)) {
        options = format;
        format = undefined;
    }

    this.$options = {
        signingScheme: DEFAULT_SIGNING_SCHEME,
        signingSchemeOptions: {
            hash: &#x27;sha256&#x27;,
            saltLength: null
        },
        encryptionScheme: DEFAULT_ENCRYPTION_SCHEME,
        encryptionSchemeOptions: {
            hash: &#x27;sha1&#x27;,
            label: null
        },
        environment: utils.detectEnvironment(),
        rsaUtils: this
    };
    this.keyPair = new rsa.Key();
    this.$cache = {};

    if (Buffer.isBuffer(key) || _.isString(key)) {
        this.importKey(key, format);
    } else if (_.isObject(key)) {
        this.generateKeyPair(key.b, key.e);
    }

    this.setOptions(options);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.node-rsa.jsbn" id="apidoc.element.node-rsa.jsbn">
        function <span class="apidocSignatureSpan">node-rsa.</span>jsbn
        <span class="apidocSignatureSpan">(a, b)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function BigInteger(a, b) {
    if (a != null) {
        if (&#x22;number&#x22; == typeof a) {
            this.fromNumber(a, b);
        } else if (Buffer.isBuffer(a)) {
            this.fromBuffer(a);
        } else if (b == null &#x26;&#x26; &#x22;string&#x22; != typeof a) {
            this.fromByteArray(a);
        } else {
            this.fromString(a, b);
        }
    }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>
























</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.node-rsa.components" id="apidoc.module.node-rsa.components">module node-rsa.components</a></h1>


    <h2>
        <a href="#apidoc.element.node-rsa.components.autoImport" id="apidoc.element.node-rsa.components.autoImport">
        function <span class="apidocSignatureSpan">node-rsa.components.</span>autoImport
        <span class="apidocSignatureSpan">(key, data)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">autoImport = function (key, data) {
    if (data.n &#x26;&#x26; data.e) {
        if (data.d &#x26;&#x26; data.p &#x26;&#x26; data.q &#x26;&#x26; data.dmp1 &#x26;&#x26; data.dmq1 &#x26;&#x26; data.coeff) {
            module.exports.privateImport(key, data);
            return true;
        } else {
            module.exports.publicImport(key, data);
            return true;
        }
    }

    return false;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    isPublicImport: function (format) {
        return module.exports[format] &#x26;&#x26; typeof module.exports[format].publicImport === &#x27;function&#x27;;
    },

    detectAndImport: function (key, data, format) {
        if (format === undefined) {
for (var scheme in module.exports) {
    if (typeof module.exports[scheme].autoImport === &#x27;function&#x27; &#x26;&#x26; module.exports[scheme].<span class="apidocCodeKeywordSpan
">autoImport</span>(key, data)) {
        return true;
    }
}
        } else if (format) {
var fmt = formatParse(format);

if (module.exports[fmt.scheme]) {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.node-rsa.components.privateExport" id="apidoc.element.node-rsa.components.privateExport">
        function <span class="apidocSignatureSpan">node-rsa.components.</span>privateExport
        <span class="apidocSignatureSpan">(key, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">privateExport = function (key, options) {
    return {
        n: key.n.toBuffer(),
        e: key.e,
        d: key.d.toBuffer(),
        p: key.p.toBuffer(),
        q: key.q.toBuffer(),
        dmp1: key.dmp1.toBuffer(),
        dmq1: key.dmq1.toBuffer(),
        coeff: key.coeff.toBuffer()
    };
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
var fmt = formatParse(format);

if (module.exports[fmt.scheme]) {
    if (fmt.keyType === &#x27;private&#x27;) {
        if (!key.isPrivate()) {
            throw Error(&#x22;This is not private key&#x22;);
        }
        return module.exports[fmt.scheme].<span class="apidocCodeKeywordSpan">privateExport</span>(key, fmt.keyOpt);
    } else {
        if (!key.isPublic()) {
            throw Error(&#x22;This is not public key&#x22;);
        }
        return module.exports[fmt.scheme].publicExport(key, fmt.keyOpt);
    }
} else {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.node-rsa.components.privateImport" id="apidoc.element.node-rsa.components.privateImport">
        function <span class="apidocSignatureSpan">node-rsa.components.</span>privateImport
        <span class="apidocSignatureSpan">(key, data, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">privateImport = function (key, data, options) {
    if (data.n &#x26;&#x26; data.e &#x26;&#x26; data.d &#x26;&#x26; data.p &#x26;&#x26; data.q &#x26;&#x26; data.dmp1 &#x26;&#x26; data.dmq1 &#x26;&#x26; data.coeff) {
        key.setPrivate(
            data.n,
            data.e,
            data.d,
            data.p,
            data.q,
            data.dmp1,
            data.dmq1,
            data.coeff
        );
    } else {
        throw Error(&#x22;Invalid key data&#x22;);
    }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
 * Trying autodetect and import key
 * @param key
 * @param data
 */
autoImport: function (key, data) {
    if (data.n &#x26;&#x26; data.e) {
        if (data.d &#x26;&#x26; data.p &#x26;&#x26; data.q &#x26;&#x26; data.dmp1 &#x26;&#x26; data.dmq1 &#x26;&#x26; data.coeff
) {
            module.exports.<span class="apidocCodeKeywordSpan">privateImport</span>(key, data);
            return true;
        } else {
            module.exports.publicImport(key, data);
            return true;
        }
    }
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.node-rsa.components.publicExport" id="apidoc.element.node-rsa.components.publicExport">
        function <span class="apidocSignatureSpan">node-rsa.components.</span>publicExport
        <span class="apidocSignatureSpan">(key, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">publicExport = function (key, options) {
    return {
        n: key.n.toBuffer(),
        e: key.e
    };
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
                        throw Error(&#x22;This is not private key&#x22;);
                    }
                    return module.exports[fmt.scheme].privateExport(key, fmt.keyOpt);
                } else {
                    if (!key.isPublic()) {
                        throw Error(&#x22;This is not public key&#x22;);
                    }
                    return module.exports[fmt.scheme].<span class="apidocCodeKeywordSpan">publicExport</span>(key, fmt.keyOpt);
                }
            } else {
                throw Error(&#x27;Unsupported key format&#x27;);
            }
        }
    }
};
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.node-rsa.components.publicImport" id="apidoc.element.node-rsa.components.publicImport">
        function <span class="apidocSignatureSpan">node-rsa.components.</span>publicImport
        <span class="apidocSignatureSpan">(key, data, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">publicImport = function (key, data, options) {
    if (data.n &#x26;&#x26; data.e) {
        key.setPublic(
            data.n,
            data.e
        );
    } else {
        throw Error(&#x22;Invalid key data&#x22;);
    }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
     */
    autoImport: function (key, data) {
        if (data.n &#x26;&#x26; data.e) {
            if (data.d &#x26;&#x26; data.p &#x26;&#x26; data.q &#x26;&#x26; data.dmp1 &#x26;&#x26; data.dmq1 &#x26;&#x26; data.coeff
) {
                module.exports.privateImport(key, data);
                return true;
            } else {
                module.exports.<span class="apidocCodeKeywordSpan">publicImport</span>(key, data);
                return true;
            }
        }

        return false;
    }
};
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.node-rsa.encryptEngines" id="apidoc.module.node-rsa.encryptEngines">module node-rsa.encryptEngines</a></h1>


    <h2>
        <a href="#apidoc.element.node-rsa.encryptEngines.getEngine" id="apidoc.element.node-rsa.encryptEngines.getEngine">
        function <span class="apidocSignatureSpan">node-rsa.encryptEngines.</span>getEngine
        <span class="apidocSignatureSpan">(keyPair, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">getEngine = function (keyPair, options) {
    var engine = require(&#x27;./js.js&#x27;);
    if (options.environment === &#x27;node&#x27;) {
        if (typeof crypt.publicEncrypt === &#x27;function&#x27; &#x26;&#x26; typeof crypt.privateDecrypt === &#x27;function&#x27;) {
            if (typeof crypt.privateEncrypt === &#x27;function&#x27; &#x26;&#x26; typeof crypt.publicDecrypt === &#x27;function&#x27;) {
                engine = require(&#x27;./io.js&#x27;);
            } else {
                engine = require(&#x27;./node12.js&#x27;);
            }
        }
    }
    return engine(keyPair, options);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    if (signingSchemeProvider === encryptionSchemeProvider) {
        this.signingScheme = this.encryptionScheme = encryptionSchemeProvider.makeScheme(this, options);
    } else {
        this.encryptionScheme = encryptionSchemeProvider.makeScheme(this, options);
        this.signingScheme = signingSchemeProvider.makeScheme(this, options);
    }

    this.encryptEngine = encryptEngines.<span class="apidocCodeKeywordSpan">getEngine</span>(this, options);
};

/**
 * Generate a new random private key B bits long, using public expt E
 * @param B
 * @param E
 */
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.node-rsa.formats" id="apidoc.module.node-rsa.formats">module node-rsa.formats</a></h1>


    <h2>
        <a href="#apidoc.element.node-rsa.formats.detectAndExport" id="apidoc.element.node-rsa.formats.detectAndExport">
        function <span class="apidocSignatureSpan">node-rsa.formats.</span>detectAndExport
        <span class="apidocSignatureSpan">(key, format)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">detectAndExport = function (key, format) {
    if (format) {
        var fmt = formatParse(format);

        if (module.exports[fmt.scheme]) {
            if (fmt.keyType === &#x27;private&#x27;) {
                if (!key.isPrivate()) {
                    throw Error(&#x22;This is not private key&#x22;);
                }
                return module.exports[fmt.scheme].privateExport(key, fmt.keyOpt);
            } else {
                if (!key.isPublic()) {
                    throw Error(&#x22;This is not public key&#x22;);
                }
                return module.exports[fmt.scheme].publicExport(key, fmt.keyOpt);
            }
        } else {
            throw Error(&#x27;Unsupported key format&#x27;);
        }
    }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
 * @param [format] {string}
 */
NodeRSA.prototype.exportKey = function (format) {
    format = format || DEFAULT_EXPORT_FORMAT;
    format = EXPORT_FORMAT_ALIASES[format] || format;

    if (!this.$cache[format]) {
        this.$cache[format] = formats.<span class="apidocCodeKeywordSpan">detectAndExport</span>(this.keyPair, format);
    }

    return this.$cache[format];
};

/**
 * Check if key pair contains private key
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.node-rsa.formats.detectAndImport" id="apidoc.element.node-rsa.formats.detectAndImport">
        function <span class="apidocSignatureSpan">node-rsa.formats.</span>detectAndImport
        <span class="apidocSignatureSpan">(key, data, format)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">detectAndImport = function (key, data, format) {
    if (format === undefined) {
        for (var scheme in module.exports) {
            if (typeof module.exports[scheme].autoImport === &#x27;function&#x27; &#x26;&#x26; module.exports[scheme].autoImport(key, data)) {
                return true;
            }
        }
    } else if (format) {
        var fmt = formatParse(format);

        if (module.exports[fmt.scheme]) {
            if (fmt.keyType === &#x27;private&#x27;) {
                module.exports[fmt.scheme].privateImport(key, data, fmt.keyOpt);
            } else {
                module.exports[fmt.scheme].publicImport(key, data, fmt.keyOpt);
            }
        } else {
            throw Error(&#x27;Unsupported key format&#x27;);
        }
    }

    return false;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
        throw Error(&#x22;Empty key given&#x22;);
    }

    if (format) {
        format = EXPORT_FORMAT_ALIASES[format] || format;
    }

    if (!formats.<span class="apidocCodeKeywordSpan">detectAndImport</span>(this.keyPair, keyData, format) &#x26;&#x26; format ===
undefined) {
        throw Error(&#x22;Key format must be specified&#x22;);
    }

    this.$cache = {};
};

/**
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.node-rsa.formats.isPrivateExport" id="apidoc.element.node-rsa.formats.isPrivateExport">
        function <span class="apidocSignatureSpan">node-rsa.formats.</span>isPrivateExport
        <span class="apidocSignatureSpan">(format)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">isPrivateExport = function (format) {
    return module.exports[format] &#x26;&#x26; typeof module.exports[format].privateExport === &#x27;function&#x27;;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.node-rsa.formats.isPrivateImport" id="apidoc.element.node-rsa.formats.isPrivateImport">
        function <span class="apidocSignatureSpan">node-rsa.formats.</span>isPrivateImport
        <span class="apidocSignatureSpan">(format)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">isPrivateImport = function (format) {
    return module.exports[format] &#x26;&#x26; typeof module.exports[format].privateImport === &#x27;function&#x27;;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.node-rsa.formats.isPublicExport" id="apidoc.element.node-rsa.formats.isPublicExport">
        function <span class="apidocSignatureSpan">node-rsa.formats.</span>isPublicExport
        <span class="apidocSignatureSpan">(format)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">isPublicExport = function (format) {
    return module.exports[format] &#x26;&#x26; typeof module.exports[format].publicExport === &#x27;function&#x27;;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.node-rsa.formats.isPublicImport" id="apidoc.element.node-rsa.formats.isPublicImport">
        function <span class="apidocSignatureSpan">node-rsa.formats.</span>isPublicImport
        <span class="apidocSignatureSpan">(format)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">isPublicImport = function (format) {
    return module.exports[format] &#x26;&#x26; typeof module.exports[format].publicImport === &#x27;function&#x27;;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>








</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.node-rsa.jsbn" id="apidoc.module.node-rsa.jsbn">module node-rsa.jsbn</a></h1>


    <h2>
        <a href="#apidoc.element.node-rsa.jsbn.jsbn" id="apidoc.element.node-rsa.jsbn.jsbn">
        function <span class="apidocSignatureSpan">node-rsa.</span>jsbn
        <span class="apidocSignatureSpan">(a, b)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function BigInteger(a, b) {
    if (a != null) {
        if (&#x22;number&#x22; == typeof a) {
            this.fromNumber(a, b);
        } else if (Buffer.isBuffer(a)) {
            this.fromBuffer(a);
        } else if (b == null &#x26;&#x26; &#x22;string&#x22; != typeof a) {
            this.fromByteArray(a);
        } else {
            this.fromString(a, b);
        }
    }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.node-rsa.jsbn.int2char" id="apidoc.element.node-rsa.jsbn.int2char">
        function <span class="apidocSignatureSpan">node-rsa.jsbn.</span>int2char
        <span class="apidocSignatureSpan">(n)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function int2char(n) {
    return BI_RM.charAt(n);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>






</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.node-rsa.jsbn.prototype" id="apidoc.module.node-rsa.jsbn.prototype">module node-rsa.jsbn.prototype</a></h1>


    <h2>
        <a href="#apidoc.element.node-rsa.jsbn.prototype.abs" id="apidoc.element.node-rsa.jsbn.prototype.abs">
        function <span class="apidocSignatureSpan">node-rsa.jsbn.prototype.</span>abs
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function bnAbs() {
    return (this.s &#x3c; 0) ? this.negate() : this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
r.t = i;
r.clamp();
}

// (protected) r = this * a, r != this,a (HAC 14.12)
// &#x22;this&#x22; should be the larger one if appropriate.
function bnpMultiplyTo(a, r) {
var x = this.<span class="apidocCodeKeywordSpan">abs</span>(), y = a.abs();
var i = x.t;
r.t = i + y.t;
while (--i &#x3e;= 0) r[i] = 0;
for (i = 0; i &#x3c; y.t; ++i) r[i + x.t] = x.am(0, y[i], r, i, 0, x.t);
r.s = 0;
r.clamp();
if (this.s != a.s) BigInteger.ZERO.subTo(r, r);
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.node-rsa.jsbn.prototype.add" id="apidoc.element.node-rsa.jsbn.prototype.add">
        function <span class="apidocSignatureSpan">node-rsa.jsbn.prototype.</span>add
        <span class="apidocSignatureSpan">(a)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function bnAdd(a) {
    var r = nbi();
    this.addTo(a, r);
    return r;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
            if (ac) c.subTo(a, c);
            d.subTo(b, d);
        }
    }
    if (v.compareTo(BigInteger.ONE) != 0) return BigInteger.ZERO;
    if (d.compareTo(m) &#x3e;= 0) return d.subtract(m);
    if (d.signum() &#x3c; 0) d.addTo(m, d); else return d;
    if (d.signum() &#x3c; 0) return d.<span class="apidocCodeKeywordSpan">add</span>(m); else return d;
}

var lowprimes = [2, 3, 5, 7, 11, 13, 17, 19, 23, 29, 31, 37, 41, 43, 47, 53, 59, 61, 67, 71, 73, 79, 83, 89, 97, 101, 103, 107,
109, 113, 127, 131, 137, 139, 149, 151, 157, 163, 167, 173, 179, 181, 191, 193, 197, 199, 211, 223, 227, 229, 233, 239, 241, 251
, 257, 263, 269, 271, 277, 281, 283, 293, 307, 311, 313, 317, 331, 337, 347, 349, 353, 359, 367, 373, 379, 383, 389, 397, 401, 409
, 419, 421, 431, 433, 439, 443, 449, 457, 461, 463, 467, 479, 487, 491, 499, 503, 509, 521, 523, 541, 547, 557, 563, 569, 571, 577
, 587, 593, 599, 601, 607, 613, 617, 619, 631, 641, 643, 647, 653, 659, 661, 673, 677, 683, 691, 701, 709, 719, 727, 733, 739, 743
, 751, 757, 761, 769, 773, 787, 797, 809, 811, 821, 823, 827, 829, 839, 853, 857, 859, 863, 877, 881, 883, 887, 907, 911, 919, 929
, 937, 941, 947, 953, 967, 971, 977, 983, 991, 997];
var lplim = (1 &#x3c;&#x3c; 26) / lowprimes[lowprimes.length - 1];

//(public) test primality with certainty &#x3e;= 1-.5^t
function bnIsProbablePrime(t) {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.node-rsa.jsbn.prototype.addTo" id="apidoc.element.node-rsa.jsbn.prototype.addTo">
        function <span class="apidocSignatureSpan">node-rsa.jsbn.prototype.</span>addTo
        <span class="apidocSignatureSpan">(a, r)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function bnpAddTo(a, r) {
    var i = 0, c = 0, m = Math.min(a.t, this.t);
    while (i &#x3c; m) {
        c += this[i] + a[i];
        r[i++] = c &#x26; this.DM;
        c &#x3e;&#x3e;= this.DB;
    }
    if (a.t &#x3c; this.t) {
        c += a.s;
        while (i &#x3c; this.t) {
            c += this[i];
            r[i++] = c &#x26; this.DM;
            c &#x3e;&#x3e;= this.DB;
        }
        c += this.s;
    }
    else {
        c += this.s;
        while (i &#x3c; a.t) {
            c += a[i];
            r[i++] = c &#x26; this.DM;
            c &#x3e;&#x3e;= this.DB;
        }
        c += a.s;
    }
    r.s = (c &#x3c; 0) ? -1 : 0;
    if (c &#x3e; 0) r[i++] = c;
    else if (c &#x3c; -1) r[i++] = this.DV + c;
    r.t = i;
    r.clamp();
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
r.t = i;
r.clamp();
}

//(public) this + a
function bnAdd(a) {
var r = nbi();
this.<span class="apidocCodeKeywordSpan">addTo</span>(a, r);
return r;
}

//(public) this - a
function bnSubtract(a) {
var r = nbi();
this.subTo(a, r);
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.node-rsa.jsbn.prototype.am" id="apidoc.element.node-rsa.jsbn.prototype.am">
        function <span class="apidocSignatureSpan">node-rsa.jsbn.prototype.</span>am
        <span class="apidocSignatureSpan">(i, x, w, j, c, n)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function am3(i, x, w, j, c, n) {
    var xl = x &#x26; 0x3fff, xh = x &#x3e;&#x3e; 14;
    while (--n &#x3e;= 0) {
        var l = this[i] &#x26; 0x3fff;
        var h = this[i++] &#x3e;&#x3e; 14;
        var m = xh * l + h * xl;
        l = xl * l + ((m &#x26; 0x3fff) &#x3c;&#x3c; 14) + w[j] + c;
        c = (l &#x3e;&#x3e; 28) + (m &#x3e;&#x3e; 14) + xh * h;
        w[j++] = l &#x26; 0xfffffff;
    }
    return c;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
// (protected) r = this * a, r != this,a (HAC 14.12)
// &#x22;this&#x22; should be the larger one if appropriate.
function bnpMultiplyTo(a, r) {
    var x = this.abs(), y = a.abs();
    var i = x.t;
    r.t = i + y.t;
    while (--i &#x3e;= 0) r[i] = 0;
    for (i = 0; i &#x3c; y.t; ++i) r[i + x.t] = x.<span class="apidocCodeKeywordSpan">am</span>(0, y[i], r, i, 0, x.t);
    r.s = 0;
    r.clamp();
    if (this.s != a.s) BigInteger.ZERO.subTo(r, r);
}

// (protected) r = this^2, r != this (HAC 14.16)
function bnpSquareTo(r) {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.node-rsa.jsbn.prototype.and" id="apidoc.element.node-rsa.jsbn.prototype.and">
        function <span class="apidocSignatureSpan">node-rsa.jsbn.prototype.</span>and
        <span class="apidocSignatureSpan">(a)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function bnAnd(a) {
    var r = nbi();
    this.bitwiseTo(a, op_and, r);
    return r;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.node-rsa.jsbn.prototype.andNot" id="apidoc.element.node-rsa.jsbn.prototype.andNot">
        function <span class="apidocSignatureSpan">node-rsa.jsbn.prototype.</span>andNot
        <span class="apidocSignatureSpan">(a)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function bnAndNot(a) {
    var r = nbi();
    this.bitwiseTo(a, op_andnot, r);
    return r;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.node-rsa.jsbn.prototype.bitCount" id="apidoc.element.node-rsa.jsbn.prototype.bitCount">
        function <span class="apidocSignatureSpan">node-rsa.jsbn.prototype.</span>bitCount
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function bnBitCount() {
    var r = 0, x = this.s &#x26; this.DM;
    for (var i = 0; i &#x3c; this.t; ++i) r += cbit(this[i] ^ x);
    return r;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.node-rsa.jsbn.prototype.bitLength" id="apidoc.element.node-rsa.jsbn.prototype.bitLength">
        function <span class="apidocSignatureSpan">node-rsa.jsbn.prototype.</span>bitLength
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function bnBitLength() {
    if (this.t &#x3c;= 0) return 0;
    return this.DB * (this.t - 1) + nbits(this[this.t - 1] ^ (this.s &#x26; this.DM));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    else {
        this.fromNumber(a);
        if (!this.testBit(a - 1))	// force MSB set
            this.bitwiseTo(BigInteger.ONE.shiftLeft(a - 1), op_or, this);
        if (this.isEven()) this.dAddOffset(1, 0); // force odd
        while (!this.isProbablePrime(b)) {
            this.dAddOffset(2, 0);
            if (this.<span class="apidocCodeKeywordSpan">bitLength</span>() &#x3e; a) this.subTo(BigInteger.ONE.shiftLeft(a - 1),
this);
        }
    }
} else {
    // new BigInteger(int,RNG)
    var x = crypt.randomBytes((a &#x3e;&#x3e; 3) + 1)
    var t = a &#x26; 7;
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.node-rsa.jsbn.prototype.bitwiseTo" id="apidoc.element.node-rsa.jsbn.prototype.bitwiseTo">
        function <span class="apidocSignatureSpan">node-rsa.jsbn.prototype.</span>bitwiseTo
        <span class="apidocSignatureSpan">(a, op, r)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function bnpBitwiseTo(a, op, r) {
    var i, f, m = Math.min(a.t, this.t);
    for (i = 0; i &#x3c; m; ++i) r[i] = op(this[i], a[i]);
    if (a.t &#x3c; this.t) {
        f = a.s &#x26; this.DM;
        for (i = m; i &#x3c; this.t; ++i) r[i] = op(this[i], f);
        r.t = this.t;
    }
    else {
        f = this.s &#x26; this.DM;
        for (i = m; i &#x3c; a.t; ++i) r[i] = op(f, a[i]);
        r.t = a.t;
    }
    r.s = op(this.s, a.s);
    r.clamp();
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
function bnpFromNumber(a, b) {
if (&#x22;number&#x22; == typeof b) {
    // new BigInteger(int,int,RNG)
    if (a &#x3c; 2) this.fromInt(1);
    else {
        this.fromNumber(a);
        if (!this.testBit(a - 1))	// force MSB set
            this.<span class="apidocCodeKeywordSpan">bitwiseTo</span>(BigInteger.ONE.shiftLeft(a - 1), op_or, this);
        if (this.isEven()) this.dAddOffset(1, 0); // force odd
        while (!this.isProbablePrime(b)) {
            this.dAddOffset(2, 0);
            if (this.bitLength() &#x3e; a) this.subTo(BigInteger.ONE.shiftLeft(a - 1), this);
        }
    }
} else {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.node-rsa.jsbn.prototype.byteValue" id="apidoc.element.node-rsa.jsbn.prototype.byteValue">
        function <span class="apidocSignatureSpan">node-rsa.jsbn.prototype.</span>byteValue
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function bnByteValue() {
    return (this.t == 0) ? this.s : (this[0] &#x3c;&#x3c; 24) &#x3e;&#x3e; 24;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.node-rsa.jsbn.prototype.changeBit" id="apidoc.element.node-rsa.jsbn.prototype.changeBit">
        function <span class="apidocSignatureSpan">node-rsa.jsbn.prototype.</span>changeBit
        <span class="apidocSignatureSpan">(n, op)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function bnpChangeBit(n, op) {
    var r = BigInteger.ONE.shiftLeft(n);
    this.bitwiseTo(r, op, r);
    return r;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    var r = BigInteger.ONE.shiftLeft(n);
    this.bitwiseTo(r, op, r);
    return r;
}

//(public) this | (1&#x3c;&#x3c;n)
function bnSetBit(n) {
    return this.<span class="apidocCodeKeywordSpan">changeBit</span>(n, op_or);
}

//(public) this &#x26; ~(1&#x3c;&#x3c;n)
function bnClearBit(n) {
    return this.changeBit(n, op_andnot);
}
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.node-rsa.jsbn.prototype.chunkSize" id="apidoc.element.node-rsa.jsbn.prototype.chunkSize">
        function <span class="apidocSignatureSpan">node-rsa.jsbn.prototype.</span>chunkSize
        <span class="apidocSignatureSpan">(r)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function bnpChunkSize(r) {
    return Math.floor(Math.LN2 * this.DB / Math.log(r));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
else return 1;
}

//(protected) convert to radix string
function bnpToRadix(b) {
if (b == null) b = 10;
if (this.signum() === 0 || b &#x3c; 2 || b &#x3e; 36) return &#x22;0&#x22;;
var cs = this.<span class="apidocCodeKeywordSpan">chunkSize</span>(b);
var a = Math.pow(b, cs);
var d = nbv(a), y = nbi(), z = nbi(), r = &#x22;&#x22;;
this.divRemTo(d, y, z);
while (y.signum() &#x3e; 0) {
    r = (a + z.intValue()).toString(b).substr(1) + r;
    y.divRemTo(d, y, z);
}
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.node-rsa.jsbn.prototype.clamp" id="apidoc.element.node-rsa.jsbn.prototype.clamp">
        function <span class="apidocSignatureSpan">node-rsa.jsbn.prototype.</span>clamp
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function bnpClamp() {
    var c = this.s &#x26; this.DM;
    while (this.t &#x3e; 0 &#x26;&#x26; this[this.t - 1] == c) --this.t;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
        sh += k;
        if (sh &#x3e;= this.DB) sh -= this.DB;
    }
    if ((!unsigned) &#x26;&#x26; k == 8 &#x26;&#x26; (data[0] &#x26; 0x80) != 0) {
        this.s = -1;
        if (sh &#x3e; 0) this[this.t - 1] |= ((1 &#x3c;&#x3c; (this.DB - sh)) - 1) &#x3c;&#x3c; sh;
    }
    this.<span class="apidocCodeKeywordSpan">clamp</span>();
    if (mi) BigInteger.ZERO.subTo(this, this);
}

function bnpFromByteArray(a, unsigned) {
    this.fromString(a, 256, unsigned)
}
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.node-rsa.jsbn.prototype.clearBit" id="apidoc.element.node-rsa.jsbn.prototype.clearBit">
        function <span class="apidocSignatureSpan">node-rsa.jsbn.prototype.</span>clearBit
        <span class="apidocSignatureSpan">(n)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function bnClearBit(n) {
    return this.changeBit(n, op_andnot);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.node-rsa.jsbn.prototype.clone" id="apidoc.element.node-rsa.jsbn.prototype.clone">
        function <span class="apidocSignatureSpan">node-rsa.jsbn.prototype.</span>clone
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function bnClone() {
    var r = nbi();
    this.copyTo(r);
    return r;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    }
}
return z.revert(r);
}

//(public) gcd(this,a) (HAC 14.54)
function bnGCD(a) {
var x = (this.s &#x3c; 0) ? this.negate() : this.<span class="apidocCodeKeywordSpan">clone</span>();
var y = (a.s &#x3c; 0) ? a.negate() : a.clone();
if (x.compareTo(y) &#x3c; 0) {
    var t = x;
    x = y;
    y = t;
}
var i = x.getLowestSetBit(), g = y.getLowestSetBit();
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.node-rsa.jsbn.prototype.compareTo" id="apidoc.element.node-rsa.jsbn.prototype.compareTo">
        function <span class="apidocSignatureSpan">node-rsa.jsbn.prototype.</span>compareTo
        <span class="apidocSignatureSpan">(a)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function bnCompareTo(a) {
    var r = this.s - a.s;
    if (r != 0) return r;
    var i = this.t;
    r = i - a.t;
    if (r != 0) return (this.s &#x3c; 0) ? -r : r;
    while (--i &#x3e;= 0) if ((r = this[i] - a[i]) != 0) return r;
    return 0;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
var ys = y.t;
var y0 = y[ys - 1];
if (y0 === 0) return;
var yt = y0 * (1 &#x3c;&#x3c; this.F1) + ((ys &#x3e; 1) ? y[ys - 2] &#x3e;&#x3e; this.F2 : 0);
var d1 = this.FV / yt, d2 = (1 &#x3c;&#x3c; this.F1) / yt, e = 1 &#x3c;&#x3c; this.F2;
var i = r.t, j = i - ys, t = (q == null) ? nbi() : q;
y.dlShiftTo(j, t);
if (r.<span class="apidocCodeKeywordSpan">compareTo</span>(t) &#x3e;= 0) {
    r[r.t++] = 1;
    r.subTo(t, r);
}
BigInteger.ONE.dlShiftTo(ys, t);
t.subTo(y, y);	// &#x22;negative&#x22; y so we can replace sub with am later
while (y.t &#x3c; ys) y[y.t++] = 0;
while (--j &#x3e;= 0) {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.node-rsa.jsbn.prototype.copyTo" id="apidoc.element.node-rsa.jsbn.prototype.copyTo">
        function <span class="apidocSignatureSpan">node-rsa.jsbn.prototype.</span>copyTo
        <span class="apidocSignatureSpan">(r)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function bnpCopyTo(r) {
    for (var i = this.t - 1; i &#x3e;= 0; --i) r[i] = this[i];
    r.t = this.t;
    r.s = this.s;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
// r != q, this != m.  q or r may be null.
function bnpDivRemTo(m, q, r) {
var pm = m.abs();
if (pm.t &#x3c;= 0) return;
var pt = this.abs();
if (pt.t &#x3c; pm.t) {
    if (q != null) q.fromInt(0);
    if (r != null) this.<span class="apidocCodeKeywordSpan">copyTo</span>(r);
    return;
}
if (r == null) r = nbi();
var y = nbi(), ts = this.s, ms = m.s;
var nsh = this.DB - nbits(pm[pm.t - 1]);	// normalize modulus
if (nsh &#x3e; 0) {
    pm.lShiftTo(nsh, y);
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.node-rsa.jsbn.prototype.dAddOffset" id="apidoc.element.node-rsa.jsbn.prototype.dAddOffset">
        function <span class="apidocSignatureSpan">node-rsa.jsbn.prototype.</span>dAddOffset
        <span class="apidocSignatureSpan">(n, w)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function bnpDAddOffset(n, w) {
    if (n === 0) return;
    while (this.t &#x3c;= w) this[this.t++] = 0;
    this[w] += n;
    while (this[w] &#x3e;= this.DV) {
        this[w] -= this.DV;
        if (++w &#x3e;= this.t) this[this.t++] = 0;
        ++this[w];
    }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    if (x &#x3c; 0) {
        if (s.charAt(i) == &#x22;-&#x22; &#x26;&#x26; this.signum() === 0) mi = true;
        continue;
    }
    w = b * w + x;
    if (++j &#x3e;= cs) {
        this.dMultiply(d);
        this.<span class="apidocCodeKeywordSpan">dAddOffset</span>(w, 0);
        j = 0;
        w = 0;
    }
}
if (j &#x3e; 0) {
    this.dMultiply(Math.pow(b, j));
    this.dAddOffset(w, 0);
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.node-rsa.jsbn.prototype.dMultiply" id="apidoc.element.node-rsa.jsbn.prototype.dMultiply">
        function <span class="apidocSignatureSpan">node-rsa.jsbn.prototype.</span>dMultiply
        <span class="apidocSignatureSpan">(n)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function bnpDMultiply(n) {
    this[this.t] = this.am(0, n - 1, this, 0, 0, this.t);
    ++this.t;
    this.clamp();
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    var x = intAt(s, i);
    if (x &#x3c; 0) {
        if (s.charAt(i) == &#x22;-&#x22; &#x26;&#x26; this.signum() === 0) mi = true;
        continue;
    }
    w = b * w + x;
    if (++j &#x3e;= cs) {
        this.<span class="apidocCodeKeywordSpan">dMultiply</span>(d);
        this.dAddOffset(w, 0);
        j = 0;
        w = 0;
    }
}
if (j &#x3e; 0) {
    this.dMultiply(Math.pow(b, j));
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.node-rsa.jsbn.prototype.divRemTo" id="apidoc.element.node-rsa.jsbn.prototype.divRemTo">
        function <span class="apidocSignatureSpan">node-rsa.jsbn.prototype.</span>divRemTo
        <span class="apidocSignatureSpan">(m, q, r)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function bnpDivRemTo(m, q, r) {
    var pm = m.abs();
    if (pm.t &#x3c;= 0) return;
    var pt = this.abs();
    if (pt.t &#x3c; pm.t) {
        if (q != null) q.fromInt(0);
        if (r != null) this.copyTo(r);
        return;
    }
    if (r == null) r = nbi();
    var y = nbi(), ts = this.s, ms = m.s;
    var nsh = this.DB - nbits(pm[pm.t - 1]);	// normalize modulus
    if (nsh &#x3e; 0) {
        pm.lShiftTo(nsh, y);
        pt.lShiftTo(nsh, r);
    }
    else {
        pm.copyTo(y);
        pt.copyTo(r);
    }
    var ys = y.t;
    var y0 = y[ys - 1];
    if (y0 === 0) return;
    var yt = y0 * (1 &#x3c;&#x3c; this.F1) + ((ys &#x3e; 1) ? y[ys - 2] &#x3e;&#x3e; this.F2 : 0);
    var d1 = this.FV / yt, d2 = (1 &#x3c;&#x3c; this.F1) / yt, e = 1 &#x3c;&#x3c; this.F2;
    var i = r.t, j = i - ys, t = (q == null) ? nbi() : q;
    y.dlShiftTo(j, t);
    if (r.compareTo(t) &#x3e;= 0) {
        r[r.t++] = 1;
        r.subTo(t, r);
    }
    BigInteger.ONE.dlShiftTo(ys, t);
    t.subTo(y, y);	// &#x22;negative&#x22; y so we can replace sub with am later
    while (y.t &#x3c; ys) y[y.t++] = 0;
    while (--j &#x3e;= 0) {
        // Estimate quotient digit
        var qd = (r[--i] == y0) ? this.DM : Math.floor(r[i] * d1 + (r[i - 1] + e) * d2);
        if ((r[i] += y.am(0, qd, r, j, 0, ys)) &#x3c; qd) {	// Try it out
            y.dlShiftTo(j, t);
            r.subTo(t, r);
            while (r[i] &#x3c; --qd) r.subTo(t, r);
        }
    }
    if (q != null) {
        r.drShiftTo(ys, q);
        if (ts != ms) BigInteger.ZERO.subTo(q, q);
    }
    r.t = ys;
    r.clamp();
    if (nsh &#x3e; 0) r.rShiftTo(nsh, r);	// Denormalize remainder
    if (ts &#x3c; 0) BigInteger.ZERO.subTo(r, r);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
if (nsh &#x3e; 0) r.rShiftTo(nsh, r);	// Denormalize remainder
if (ts &#x3c; 0) BigInteger.ZERO.subTo(r, r);
}

// (public) this mod a
function bnMod(a) {
var r = nbi();
this.abs().<span class="apidocCodeKeywordSpan">divRemTo</span>(a, null, r);
if (this.s &#x3c; 0 &#x26;&#x26; r.compareTo(BigInteger.ZERO) &#x3e; 0) a.subTo(r, r);
return r;
}

// Modular reduction using &#x22;classic&#x22; algorithm
function Classic(m) {
this.m = m;
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.node-rsa.jsbn.prototype.divide" id="apidoc.element.node-rsa.jsbn.prototype.divide">
        function <span class="apidocSignatureSpan">node-rsa.jsbn.prototype.</span>divide
        <span class="apidocSignatureSpan">(a)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function bnDivide(a) {
    var r = nbi();
    this.divRemTo(a, r, null);
    return r;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

//Barrett modular reduction
function Barrett(m) {
// setup Barrett
this.r2 = nbi();
this.q3 = nbi();
BigInteger.ONE.dlShiftTo(2 * m.t, this.r2);
this.mu = this.r2.<span class="apidocCodeKeywordSpan">divide</span>(m);
this.m = m;
}

function barrettConvert(x) {
if (x.s &#x3c; 0 || x.t &#x3e; 2 * this.m.t) return x.mod(this.m);
else if (x.compareTo(this.m) &#x3c; 0) return x;
else {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.node-rsa.jsbn.prototype.divideAndRemainder" id="apidoc.element.node-rsa.jsbn.prototype.divideAndRemainder">
        function <span class="apidocSignatureSpan">node-rsa.jsbn.prototype.</span>divideAndRemainder
        <span class="apidocSignatureSpan">(a)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function bnDivideAndRemainder(a) {
    var q = nbi(), r = nbi();
    this.divRemTo(a, q, r);
    return new Array(q, r);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.node-rsa.jsbn.prototype.dlShiftTo" id="apidoc.element.node-rsa.jsbn.prototype.dlShiftTo">
        function <span class="apidocSignatureSpan">node-rsa.jsbn.prototype.</span>dlShiftTo
        <span class="apidocSignatureSpan">(n, r)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function bnpDLShiftTo(n, r) {
    var i;
    for (i = this.t - 1; i &#x3e;= 0; --i) r[i + n] = this[i];
    for (i = n - 1; i &#x3e;= 0; --i) r[i] = 0;
    r.t = this.t + n;
    r.s = this.s;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
}
var ys = y.t;
var y0 = y[ys - 1];
if (y0 === 0) return;
var yt = y0 * (1 &#x3c;&#x3c; this.F1) + ((ys &#x3e; 1) ? y[ys - 2] &#x3e;&#x3e; this.F2 : 0);
var d1 = this.FV / yt, d2 = (1 &#x3c;&#x3c; this.F1) / yt, e = 1 &#x3c;&#x3c; this.F2;
var i = r.t, j = i - ys, t = (q == null) ? nbi() : q;
y.<span class="apidocCodeKeywordSpan">dlShiftTo</span>(j, t);
if (r.compareTo(t) &#x3e;= 0) {
    r[r.t++] = 1;
    r.subTo(t, r);
}
BigInteger.ONE.dlShiftTo(ys, t);
t.subTo(y, y);	// &#x22;negative&#x22; y so we can replace sub with am later
while (y.t &#x3c; ys) y[y.t++] = 0;
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.node-rsa.jsbn.prototype.drShiftTo" id="apidoc.element.node-rsa.jsbn.prototype.drShiftTo">
        function <span class="apidocSignatureSpan">node-rsa.jsbn.prototype.</span>drShiftTo
        <span class="apidocSignatureSpan">(n, r)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function bnpDRShiftTo(n, r) {
    for (var i = n; i &#x3c; this.t; ++i) r[i - n] = this[i];
    r.t = Math.max(this.t - n, 0);
    r.s = this.s;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
        if ((r[i] += y.am(0, qd, r, j, 0, ys)) &#x3c; qd) {	// Try it out
            y.dlShiftTo(j, t);
            r.subTo(t, r);
            while (r[i] &#x3c; --qd) r.subTo(t, r);
        }
    }
    if (q != null) {
        r.<span class="apidocCodeKeywordSpan">drShiftTo</span>(ys, q);
        if (ts != ms) BigInteger.ZERO.subTo(q, q);
    }
    r.t = ys;
    r.clamp();
    if (nsh &#x3e; 0) r.rShiftTo(nsh, r);	// Denormalize remainder
    if (ts &#x3c; 0) BigInteger.ZERO.subTo(r, r);
}
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.node-rsa.jsbn.prototype.equals" id="apidoc.element.node-rsa.jsbn.prototype.equals">
        function <span class="apidocSignatureSpan">node-rsa.jsbn.prototype.</span>equals
        <span class="apidocSignatureSpan">(a)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function bnEquals(a) {
    return (this.compareTo(a) == 0);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.node-rsa.jsbn.prototype.exp" id="apidoc.element.node-rsa.jsbn.prototype.exp">
        function <span class="apidocSignatureSpan">node-rsa.jsbn.prototype.</span>exp
        <span class="apidocSignatureSpan">(e, z)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function bnpExp(e, z) {
    if (e &#x3e; 0xffffffff || e &#x3c; 1) return BigInteger.ONE;
    var r = nbi(), r2 = nbi(), g = z.convert(this), i = nbits(e) - 1;
    g.copyTo(r);
    while (--i &#x3e;= 0) {
        z.sqrTo(r, r2);
        if ((e &#x26; (1 &#x3c;&#x3c; i)) &#x3e; 0) z.mulTo(r2, g, r);
        else {
            var t = r;
            r = r2;
            r2 = t;
        }
    }
    return z.revert(r);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    return z.revert(r);
}

// (public) this^e % m, 0 &#x3c;= e &#x3c; 2^32
function bnModPowInt(e, m) {
    var z;
    if (e &#x3c; 256 || m.isEven()) z = new Classic(m); else z = new Montgomery(m);
    return this.<span class="apidocCodeKeywordSpan">exp</span>(e, z);
}

// Copyright (c) 2005-2009  Tom Wu
// All Rights Reserved.
// See &#x22;LICENSE&#x22; for details.

// Extended JavaScript BN functions, required for RSA private ops.
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.node-rsa.jsbn.prototype.flipBit" id="apidoc.element.node-rsa.jsbn.prototype.flipBit">
        function <span class="apidocSignatureSpan">node-rsa.jsbn.prototype.</span>flipBit
        <span class="apidocSignatureSpan">(n)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function bnFlipBit(n) {
    return this.changeBit(n, op_xor);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.node-rsa.jsbn.prototype.fromBuffer" id="apidoc.element.node-rsa.jsbn.prototype.fromBuffer">
        function <span class="apidocSignatureSpan">node-rsa.jsbn.prototype.</span>fromBuffer
        <span class="apidocSignatureSpan">(a)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function bnpFromBuffer(a) {
    this.fromString(a, 256, true)
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

// (public) Constructor
function BigInteger(a, b) {
    if (a != null) {
        if (&#x22;number&#x22; == typeof a) {
            this.fromNumber(a, b);
        } else if (Buffer.isBuffer(a)) {
            this.<span class="apidocCodeKeywordSpan">fromBuffer</span>(a);
        } else if (b == null &#x26;&#x26; &#x22;string&#x22; != typeof a) {
            this.fromByteArray(a);
        } else {
            this.fromString(a, b);
        }
    }
}
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.node-rsa.jsbn.prototype.fromByteArray" id="apidoc.element.node-rsa.jsbn.prototype.fromByteArray">
        function <span class="apidocSignatureSpan">node-rsa.jsbn.prototype.</span>fromByteArray
        <span class="apidocSignatureSpan">(a, unsigned)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function bnpFromByteArray(a, unsigned) {
    this.fromString(a, 256, unsigned)
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
function BigInteger(a, b) {
    if (a != null) {
        if (&#x22;number&#x22; == typeof a) {
            this.fromNumber(a, b);
        } else if (Buffer.isBuffer(a)) {
            this.fromBuffer(a);
        } else if (b == null &#x26;&#x26; &#x22;string&#x22; != typeof a) {
            this.<span class="apidocCodeKeywordSpan">fromByteArray</span>(a);
        } else {
            this.fromString(a, b);
        }
    }
}

// return new, unset BigInteger
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.node-rsa.jsbn.prototype.fromInt" id="apidoc.element.node-rsa.jsbn.prototype.fromInt">
        function <span class="apidocSignatureSpan">node-rsa.jsbn.prototype.</span>fromInt
        <span class="apidocSignatureSpan">(x)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function bnpFromInt(x) {
    this.t = 1;
    this.s = (x &#x3c; 0) ? -1 : 0;
    if (x &#x3e; 0) this[0] = x;
    else if (x &#x3c; -1) this[0] = x + DV;
    else this.t = 0;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
else if (x &#x3c; -1) this[0] = x + DV;
else this.t = 0;
}

// return bigint initialized to value
function nbv(i) {
var r = nbi();
r.<span class="apidocCodeKeywordSpan">fromInt</span>(i);
return r;
}

// (protected) set from string and radix
function bnpFromString(data, radix, unsigned) {
var k;
switch (radix) {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.node-rsa.jsbn.prototype.fromNumber" id="apidoc.element.node-rsa.jsbn.prototype.fromNumber">
        function <span class="apidocSignatureSpan">node-rsa.jsbn.prototype.</span>fromNumber
        <span class="apidocSignatureSpan">(a, b)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function bnpFromNumber(a, b) {
    if (&#x22;number&#x22; == typeof b) {
        // new BigInteger(int,int,RNG)
        if (a &#x3c; 2) this.fromInt(1);
        else {
            this.fromNumber(a);
            if (!this.testBit(a - 1))	// force MSB set
                this.bitwiseTo(BigInteger.ONE.shiftLeft(a - 1), op_or, this);
            if (this.isEven()) this.dAddOffset(1, 0); // force odd
            while (!this.isProbablePrime(b)) {
                this.dAddOffset(2, 0);
                if (this.bitLength() &#x3e; a) this.subTo(BigInteger.ONE.shiftLeft(a - 1), this);
            }
        }
    } else {
        // new BigInteger(int,RNG)
        var x = crypt.randomBytes((a &#x3e;&#x3e; 3) + 1)
        var t = a &#x26; 7;

        if (t &#x3e; 0)
            x[0] &#x26;= ((1 &#x3c;&#x3c; t) - 1);
        else
            x[0] = 0;

        this.fromByteArray(x);
    }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
var canary = 0xdeadbeefcafe;
var j_lm = ((canary &#x26; 0xffffff) == 0xefcafe);

// (public) Constructor
function BigInteger(a, b) {
if (a != null) {
    if (&#x22;number&#x22; == typeof a) {
        this.<span class="apidocCodeKeywordSpan">fromNumber</span>(a, b);
    } else if (Buffer.isBuffer(a)) {
        this.fromBuffer(a);
    } else if (b == null &#x26;&#x26; &#x22;string&#x22; != typeof a) {
        this.fromByteArray(a);
    } else {
        this.fromString(a, b);
    }
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.node-rsa.jsbn.prototype.fromRadix" id="apidoc.element.node-rsa.jsbn.prototype.fromRadix">
        function <span class="apidocSignatureSpan">node-rsa.jsbn.prototype.</span>fromRadix
        <span class="apidocSignatureSpan">(s, b)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function bnpFromRadix(s, b) {
    this.fromInt(0);
    if (b == null) b = 10;
    var cs = this.chunkSize(b);
    var d = Math.pow(b, cs), mi = false, j = 0, w = 0;
    for (var i = 0; i &#x3c; s.length; ++i) {
        var x = intAt(s, i);
        if (x &#x3c; 0) {
            if (s.charAt(i) == &#x22;-&#x22; &#x26;&#x26; this.signum() === 0) mi = true;
            continue;
        }
        w = b * w + x;
        if (++j &#x3e;= cs) {
            this.dMultiply(d);
            this.dAddOffset(w, 0);
            j = 0;
            w = 0;
        }
    }
    if (j &#x3e; 0) {
        this.dMultiply(Math.pow(b, j));
        this.dAddOffset(w, 0);
    }
    if (mi) BigInteger.ZERO.subTo(this, this);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    case 32:
        k = 5;
        break;
    case 256:
        k = 8;
        break;
    default:
        this.<span class="apidocCodeKeywordSpan">fromRadix</span>(data, radix);
        return;
}

this.t = 0;
this.s = 0;

var i = data.length;
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.node-rsa.jsbn.prototype.fromString" id="apidoc.element.node-rsa.jsbn.prototype.fromString">
        function <span class="apidocSignatureSpan">node-rsa.jsbn.prototype.</span>fromString
        <span class="apidocSignatureSpan">(data, radix, unsigned)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function bnpFromString(data, radix, unsigned) {
    var k;
    switch (radix) {
        case 2:
            k = 1;
            break;
        case 4:
            k = 2;
            break;
        case 8:
            k = 3;
            break;
        case 16:
            k = 4;
            break;
        case 32:
            k = 5;
            break;
        case 256:
            k = 8;
            break;
        default:
            this.fromRadix(data, radix);
            return;
    }

    this.t = 0;
    this.s = 0;

    var i = data.length;
    var mi = false;
    var sh = 0;

    while (--i &#x3e;= 0) {
        var x = (k == 8) ? data[i] &#x26; 0xff : intAt(data, i);
        if (x &#x3c; 0) {
            if (data.charAt(i) == &#x22;-&#x22;) mi = true;
            continue;
        }
        mi = false;
        if (sh === 0)
            this[this.t++] = x;
        else if (sh + k &#x3e; this.DB) {
            this[this.t - 1] |= (x &#x26; ((1 &#x3c;&#x3c; (this.DB - sh)) - 1)) &#x3c;&#x3c; sh;
            this[this.t++] = (x &#x3e;&#x3e; (this.DB - sh));
        }
        else
            this[this.t - 1] |= x &#x3c;&#x3c; sh;
        sh += k;
        if (sh &#x3e;= this.DB) sh -= this.DB;
    }
    if ((!unsigned) &#x26;&#x26; k == 8 &#x26;&#x26; (data[0] &#x26; 0x80) != 0) {
        this.s = -1;
        if (sh &#x3e; 0) this[this.t - 1] |= ((1 &#x3c;&#x3c; (this.DB - sh)) - 1) &#x3c;&#x3c; sh;
    }
    this.clamp();
    if (mi) BigInteger.ZERO.subTo(this, this);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    if (&#x22;number&#x22; == typeof a) {
        this.fromNumber(a, b);
    } else if (Buffer.isBuffer(a)) {
        this.fromBuffer(a);
    } else if (b == null &#x26;&#x26; &#x22;string&#x22; != typeof a) {
        this.fromByteArray(a);
    } else {
        this.<span class="apidocCodeKeywordSpan">fromString</span>(a, b);
    }
}
}

// return new, unset BigInteger
function nbi() {
return new BigInteger(null);
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.node-rsa.jsbn.prototype.gcd" id="apidoc.element.node-rsa.jsbn.prototype.gcd">
        function <span class="apidocSignatureSpan">node-rsa.jsbn.prototype.</span>gcd
        <span class="apidocSignatureSpan">(a)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function bnGCD(a) {
    var x = (this.s &#x3c; 0) ? this.negate() : this.clone();
    var y = (a.s &#x3c; 0) ? a.negate() : a.clone();
    if (x.compareTo(y) &#x3c; 0) {
        var t = x;
        x = y;
        y = t;
    }
    var i = x.getLowestSetBit(), g = y.getLowestSetBit();
    if (g &#x3c; 0) return x;
    if (i &#x3c; g) g = i;
    if (g &#x3e; 0) {
        x.rShiftTo(g, x);
        y.rShiftTo(g, y);
    }
    while (x.signum() &#x3e; 0) {
        if ((i = x.getLowestSetBit()) &#x3e; 0) x.rShiftTo(i, x);
        if ((i = y.getLowestSetBit()) &#x3e; 0) y.rShiftTo(i, y);
        if (x.compareTo(y) &#x3e;= 0) {
            x.subTo(y, x);
            x.rShiftTo(1, x);
        }
        else {
            y.subTo(x, y);
            y.rShiftTo(1, y);
        }
    }
    if (g &#x3e; 0) y.lShiftTo(g, y);
    return y;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    RSAKey.prototype.generate = function (B, E) {
var qs = B &#x3e;&#x3e; 1;
this.e = parseInt(E, 16);
var ee = new BigInteger(E, 16);
while (true) {
    while (true) {
        this.p = new BigInteger(B - qs, 1);
        if (this.p.subtract(BigInteger.ONE).<span class="apidocCodeKeywordSpan">gcd</span>(ee).compareTo(BigInteger.ONE) === 0 &#
x26;&#x26; this.p.isProbablePrime(10))
            break;
    }
    while (true) {
        this.q = new BigInteger(qs, 1);
        if (this.q.subtract(BigInteger.ONE).gcd(ee).compareTo(BigInteger.ONE) === 0 &#x26;&#x26; this.q.isProbablePrime(10))
            break;
    }
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.node-rsa.jsbn.prototype.getLowestSetBit" id="apidoc.element.node-rsa.jsbn.prototype.getLowestSetBit">
        function <span class="apidocSignatureSpan">node-rsa.jsbn.prototype.</span>getLowestSetBit
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function bnGetLowestSetBit() {
    for (var i = 0; i &#x3c; this.t; ++i)
        if (this[i] != 0) return i * this.DB + lbit(this[i]);
    if (this.s &#x3c; 0) return this.t * this.DB;
    return -1;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
var x = (this.s &#x3c; 0) ? this.negate() : this.clone();
var y = (a.s &#x3c; 0) ? a.negate() : a.clone();
if (x.compareTo(y) &#x3c; 0) {
    var t = x;
    x = y;
    y = t;
}
var i = x.<span class="apidocCodeKeywordSpan">getLowestSetBit</span>(), g = y.getLowestSetBit();
if (g &#x3c; 0) return x;
if (i &#x3c; g) g = i;
if (g &#x3e; 0) {
    x.rShiftTo(g, x);
    y.rShiftTo(g, y);
}
while (x.signum() &#x3e; 0) {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.node-rsa.jsbn.prototype.intValue" id="apidoc.element.node-rsa.jsbn.prototype.intValue">
        function <span class="apidocSignatureSpan">node-rsa.jsbn.prototype.</span>intValue
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function bnIntValue() {
    if (this.s &#x3c; 0) {
        if (this.t == 1) return this[0] - this.DV;
        else if (this.t === 0) return -1;
    }
    else if (this.t == 1) return this[0];
    else if (this.t === 0) return 0;
// assumes 16 &#x3c; DB &#x3c; 32
    return ((this[1] &#x26; ((1 &#x3c;&#x3c; (32 - this.DB)) - 1)) &#x3c;&#x3c; this.DB) | this[0];
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    if (b == null) b = 10;
    if (this.signum() === 0 || b &#x3c; 2 || b &#x3e; 36) return &#x22;0&#x22;;
    var cs = this.chunkSize(b);
    var a = Math.pow(b, cs);
    var d = nbv(a), y = nbi(), z = nbi(), r = &#x22;&#x22;;
    this.divRemTo(d, y, z);
    while (y.signum() &#x3e; 0) {
        r = (a + z.<span class="apidocCodeKeywordSpan">intValue</span>()).toString(b).substr(1) + r;
        y.divRemTo(d, y, z);
    }
    return z.intValue().toString(b) + r;
}

//(protected) convert from radix string
function bnpFromRadix(s, b) {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.node-rsa.jsbn.prototype.invDigit" id="apidoc.element.node-rsa.jsbn.prototype.invDigit">
        function <span class="apidocSignatureSpan">node-rsa.jsbn.prototype.</span>invDigit
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function bnpInvDigit() {
    if (this.t &#x3c; 1) return 0;
    var x = this[0];
    if ((x &#x26; 1) === 0) return 0;
    var y = x &#x26; 3;		// y == 1/x mod 2^2
    y = (y * (2 - (x &#x26; 0xf) * y)) &#x26; 0xf;	// y == 1/x mod 2^4
    y = (y * (2 - (x &#x26; 0xff) * y)) &#x26; 0xff;	// y == 1/x mod 2^8
    y = (y * (2 - (((x &#x26; 0xffff) * y) &#x26; 0xffff))) &#x26; 0xffff;	// y == 1/x mod 2^16
    // last step - calculate inverse mod DV directly;
    // assumes 16 &#x3c; DB &#x3c;= 32 and assumes ability to handle 48-bit ints
    y = (y * (2 - x * y % this.DV)) % this.DV;		// y == 1/x mod 2^dbits
    // we really want the negative inverse, and -DV &#x3c; y &#x3c; DV
    return (y &#x3e; 0) ? this.DV - y : -y;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    // we really want the negative inverse, and -DV &#x3c; y &#x3c; DV
    return (y &#x3e; 0) ? this.DV - y : -y;
}

// Montgomery reduction
function Montgomery(m) {
    this.m = m;
    this.mp = m.<span class="apidocCodeKeywordSpan">invDigit</span>();
    this.mpl = this.mp &#x26; 0x7fff;
    this.mph = this.mp &#x3e;&#x3e; 15;
    this.um = (1 &#x3c;&#x3c; (m.DB - 15)) - 1;
    this.mt2 = 2 * m.t;
}

// xR mod m
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.node-rsa.jsbn.prototype.isEven" id="apidoc.element.node-rsa.jsbn.prototype.isEven">
        function <span class="apidocSignatureSpan">node-rsa.jsbn.prototype.</span>isEven
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function bnpIsEven() {
    return ((this.t &#x3e; 0) ? (this[0] &#x26; 1) : this.s) === 0;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    }
    return z.revert(r);
}

// (public) this^e % m, 0 &#x3c;= e &#x3c; 2^32
function bnModPowInt(e, m) {
    var z;
    if (e &#x3c; 256 || m.<span class="apidocCodeKeywordSpan">isEven</span>()) z = new Classic(m); else z = new Montgomery(m);
    return this.exp(e, z);
}

// Copyright (c) 2005-2009  Tom Wu
// All Rights Reserved.
// See &#x22;LICENSE&#x22; for details.
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.node-rsa.jsbn.prototype.isProbablePrime" id="apidoc.element.node-rsa.jsbn.prototype.isProbablePrime">
        function <span class="apidocSignatureSpan">node-rsa.jsbn.prototype.</span>isProbablePrime
        <span class="apidocSignatureSpan">(t)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function bnIsProbablePrime(t) {
    var i, x = this.abs();
    if (x.t == 1 &#x26;&#x26; x[0] &#x3c;= lowprimes[lowprimes.length - 1]) {
        for (i = 0; i &#x3c; lowprimes.length; ++i)
            if (x[0] == lowprimes[i]) return true;
        return false;
    }
    if (x.isEven()) return false;
    i = 1;
    while (i &#x3c; lowprimes.length) {
        var m = lowprimes[i], j = i + 1;
        while (j &#x3c; lowprimes.length &#x26;&#x26; m &#x3c; lplim) m *= lowprimes[j++];
        m = x.modInt(m);
        while (i &#x3c; j) if (m % lowprimes[i++] === 0) return false;
    }
    return x.millerRabin(t);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    // new BigInteger(int,int,RNG)
    if (a &#x3c; 2) this.fromInt(1);
    else {
        this.fromNumber(a);
        if (!this.testBit(a - 1))	// force MSB set
            this.bitwiseTo(BigInteger.ONE.shiftLeft(a - 1), op_or, this);
        if (this.isEven()) this.dAddOffset(1, 0); // force odd
        while (!this.<span class="apidocCodeKeywordSpan">isProbablePrime</span>(b)) {
            this.dAddOffset(2, 0);
            if (this.bitLength() &#x3e; a) this.subTo(BigInteger.ONE.shiftLeft(a - 1), this);
        }
    }
} else {
    // new BigInteger(int,RNG)
    var x = crypt.randomBytes((a &#x3e;&#x3e; 3) + 1)
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.node-rsa.jsbn.prototype.lShiftTo" id="apidoc.element.node-rsa.jsbn.prototype.lShiftTo">
        function <span class="apidocSignatureSpan">node-rsa.jsbn.prototype.</span>lShiftTo
        <span class="apidocSignatureSpan">(n, r)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function bnpLShiftTo(n, r) {
    var bs = n % this.DB;
    var cbs = this.DB - bs;
    var bm = (1 &#x3c;&#x3c; cbs) - 1;
    var ds = Math.floor(n / this.DB), c = (this.s &#x3c;&#x3c; bs) &#x26; this.DM, i;
    for (i = this.t - 1; i &#x3e;= 0; --i) {
        r[i + ds + 1] = (this[i] &#x3e;&#x3e; cbs) | c;
        c = (this[i] &#x26; bm) &#x3c;&#x3c; bs;
    }
    for (i = ds - 1; i &#x3e;= 0; --i) r[i] = 0;
    r[ds] = c;
    r.t = this.t + ds + 1;
    r.s = this.s;
    r.clamp();
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    if (r != null) this.copyTo(r);
    return;
}
if (r == null) r = nbi();
var y = nbi(), ts = this.s, ms = m.s;
var nsh = this.DB - nbits(pm[pm.t - 1]);	// normalize modulus
if (nsh &#x3e; 0) {
    pm.<span class="apidocCodeKeywordSpan">lShiftTo</span>(nsh, y);
    pt.lShiftTo(nsh, r);
}
else {
    pm.copyTo(y);
    pt.copyTo(r);
}
var ys = y.t;
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.node-rsa.jsbn.prototype.max" id="apidoc.element.node-rsa.jsbn.prototype.max">
        function <span class="apidocSignatureSpan">node-rsa.jsbn.prototype.</span>max
        <span class="apidocSignatureSpan">(a)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function bnMax(a) {
    return (this.compareTo(a) &#x3e; 0) ? this : a;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
r.t = this.t + n;
r.s = this.s;
}

// (protected) r = this &#x3e;&#x3e; n*DB
function bnpDRShiftTo(n, r) {
for (var i = n; i &#x3c; this.t; ++i) r[i - n] = this[i];
r.t = Math.<span class="apidocCodeKeywordSpan">max</span>(this.t - n, 0);
r.s = this.s;
}

// (protected) r = this &#x3c;&#x3c; n
function bnpLShiftTo(n, r) {
var bs = n % this.DB;
var cbs = this.DB - bs;
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.node-rsa.jsbn.prototype.millerRabin" id="apidoc.element.node-rsa.jsbn.prototype.millerRabin">
        function <span class="apidocSignatureSpan">node-rsa.jsbn.prototype.</span>millerRabin
        <span class="apidocSignatureSpan">(t)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function bnpMillerRabin(t) {
    var n1 = this.subtract(BigInteger.ONE);
    var k = n1.getLowestSetBit();
    if (k &#x3c;= 0) return false;
    var r = n1.shiftRight(k);
    t = (t + 1) &#x3e;&#x3e; 1;
    if (t &#x3e; lowprimes.length) t = lowprimes.length;
    var a = nbi();
    for (var i = 0; i &#x3c; t; ++i) {
        //Pick bases at random, instead of starting at 2
        a.fromInt(lowprimes[Math.floor(Math.random() * lowprimes.length)]);
        var y = a.modPow(r, this);
        if (y.compareTo(BigInteger.ONE) != 0 &#x26;&#x26; y.compareTo(n1) != 0) {
            var j = 1;
            while (j++ &#x3c; k &#x26;&#x26; y.compareTo(n1) != 0) {
                y = y.modPowInt(2, this);
                if (y.compareTo(BigInteger.ONE) === 0) return false;
            }
            if (y.compareTo(n1) != 0) return false;
        }
    }
    return true;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
i = 1;
while (i &#x3c; lowprimes.length) {
    var m = lowprimes[i], j = i + 1;
    while (j &#x3c; lowprimes.length &#x26;&#x26; m &#x3c; lplim) m *= lowprimes[j++];
    m = x.modInt(m);
    while (i &#x3c; j) if (m % lowprimes[i++] === 0) return false;
}
return x.<span class="apidocCodeKeywordSpan">millerRabin</span>(t);
}

//(protected) true if probably prime (HAC 4.24, Miller-Rabin)
function bnpMillerRabin(t) {
var n1 = this.subtract(BigInteger.ONE);
var k = n1.getLowestSetBit();
if (k &#x3c;= 0) return false;
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.node-rsa.jsbn.prototype.min" id="apidoc.element.node-rsa.jsbn.prototype.min">
        function <span class="apidocSignatureSpan">node-rsa.jsbn.prototype.</span>min
        <span class="apidocSignatureSpan">(a)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function bnMin(a) {
    return (this.compareTo(a) &#x3c; 0) ? this : a;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
if (bs &#x3e; 0) r[this.t - ds - 1] |= (this.s &#x26; bm) &#x3c;&#x3c; cbs;
r.t = this.t - ds;
r.clamp();
}

// (protected) r = this - a
function bnpSubTo(a, r) {
var i = 0, c = 0, m = Math.<span class="apidocCodeKeywordSpan">min</span>(a.t, this.t);
while (i &#x3c; m) {
    c += this[i] - a[i];
    r[i++] = c &#x26; this.DM;
    c &#x3e;&#x3e;= this.DB;
}
if (a.t &#x3c; this.t) {
    c -= a.s;
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.node-rsa.jsbn.prototype.mod" id="apidoc.element.node-rsa.jsbn.prototype.mod">
        function <span class="apidocSignatureSpan">node-rsa.jsbn.prototype.</span>mod
        <span class="apidocSignatureSpan">(a)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function bnMod(a) {
    var r = nbi();
    this.abs().divRemTo(a, null, r);
    if (this.s &#x3c; 0 &#x26;&#x26; r.compareTo(BigInteger.ZERO) &#x3e; 0) a.subTo(r, r);
    return r;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
}

// Modular reduction using &#x22;classic&#x22; algorithm
function Classic(m) {
this.m = m;
}
function cConvert(x) {
if (x.s &#x3c; 0 || x.compareTo(this.m) &#x3e;= 0) return x.<span class="apidocCodeKeywordSpan">mod</span>(this.m);
else return x;
}
function cRevert(x) {
return x;
}
function cReduce(x) {
x.divRemTo(this.m, null, x);
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.node-rsa.jsbn.prototype.modInt" id="apidoc.element.node-rsa.jsbn.prototype.modInt">
        function <span class="apidocSignatureSpan">node-rsa.jsbn.prototype.</span>modInt
        <span class="apidocSignatureSpan">(n)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function bnpModInt(n) {
    if (n &#x3c;= 0) return 0;
    var d = this.DV % n, r = (this.s &#x3c; 0) ? n - 1 : 0;
    if (this.t &#x3e; 0)
        if (d === 0) r = this[0] % n;
        else for (var i = this.t - 1; i &#x3e;= 0; --i) r = (d * r + this[i]) % n;
    return r;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
        return false;
    }
    if (x.isEven()) return false;
    i = 1;
    while (i &#x3c; lowprimes.length) {
        var m = lowprimes[i], j = i + 1;
        while (j &#x3c; lowprimes.length &#x26;&#x26; m &#x3c; lplim) m *= lowprimes[j++];
        m = x.<span class="apidocCodeKeywordSpan">modInt</span>(m);
        while (i &#x3c; j) if (m % lowprimes[i++] === 0) return false;
    }
    return x.millerRabin(t);
}

//(protected) true if probably prime (HAC 4.24, Miller-Rabin)
function bnpMillerRabin(t) {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.node-rsa.jsbn.prototype.modInverse" id="apidoc.element.node-rsa.jsbn.prototype.modInverse">
        function <span class="apidocSignatureSpan">node-rsa.jsbn.prototype.</span>modInverse
        <span class="apidocSignatureSpan">(m)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function bnModInverse(m) {
    var ac = m.isEven();
    if ((this.isEven() &#x26;&#x26; ac) || m.signum() === 0) return BigInteger.ZERO;
    var u = m.clone(), v = this.clone();
    var a = nbv(1), b = nbv(0), c = nbv(0), d = nbv(1);
    while (u.signum() != 0) {
        while (u.isEven()) {
            u.rShiftTo(1, u);
            if (ac) {
                if (!a.isEven() || !b.isEven()) {
                    a.addTo(this, a);
                    b.subTo(m, b);
                }
                a.rShiftTo(1, a);
            }
            else if (!b.isEven()) b.subTo(m, b);
            b.rShiftTo(1, b);
        }
        while (v.isEven()) {
            v.rShiftTo(1, v);
            if (ac) {
                if (!c.isEven() || !d.isEven()) {
                    c.addTo(this, c);
                    d.subTo(m, d);
                }
                c.rShiftTo(1, c);
            }
            else if (!d.isEven()) d.subTo(m, d);
            d.rShiftTo(1, d);
        }
        if (u.compareTo(v) &#x3e;= 0) {
            u.subTo(v, u);
            if (ac) a.subTo(c, a);
            b.subTo(d, b);
        }
        else {
            v.subTo(u, v);
            if (ac) c.subTo(a, c);
            d.subTo(b, d);
        }
    }
    if (v.compareTo(BigInteger.ONE) != 0) return BigInteger.ZERO;
    if (d.compareTo(m) &#x3e;= 0) return d.subtract(m);
    if (d.signum() &#x3c; 0) d.addTo(m, d); else return d;
    if (d.signum() &#x3c; 0) return d.add(m); else return d;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    var q1 = this.q.subtract(BigInteger.ONE);
    var phi = p1.multiply(q1);
    if (phi.gcd(ee).compareTo(BigInteger.ONE) === 0) {
        this.n = this.p.multiply(this.q);
        if (this.n.bitLength() &#x3c; B) {
            continue;
        }
        this.d = ee.<span class="apidocCodeKeywordSpan">modInverse</span>(phi);
        this.dmp1 = this.d.mod(p1);
        this.dmq1 = this.d.mod(q1);
        this.coeff = this.q.modInverse(this.p);
        break;
    }
}
this.$$recalculateCache();
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.node-rsa.jsbn.prototype.modPow" id="apidoc.element.node-rsa.jsbn.prototype.modPow">
        function <span class="apidocSignatureSpan">node-rsa.jsbn.prototype.</span>modPow
        <span class="apidocSignatureSpan">(e, m)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function bnModPow(e, m) {
    var i = e.bitLength(), k, r = nbv(1), z;
    if (i &#x3c;= 0) return r;
    else if (i &#x3c; 18) k = 1;
    else if (i &#x3c; 48) k = 3;
    else if (i &#x3c; 144) k = 4;
    else if (i &#x3c; 768) k = 5;
    else k = 6;
    if (i &#x3c; 8)
        z = new Classic(m);
    else if (m.isEven())
        z = new Barrett(m);
    else
        z = new Montgomery(m);

// precomputation
    var g = new Array(), n = 3, k1 = k - 1, km = (1 &#x3c;&#x3c; k) - 1;
    g[1] = z.convert(this);
    if (k &#x3e; 1) {
        var g2 = nbi();
        z.sqrTo(g[1], g2);
        while (n &#x3c;= km) {
            g[n] = nbi();
            z.mulTo(g2, g[n - 2], g[n]);
            n += 2;
        }
    }

    var j = e.t - 1, w, is1 = true, r2 = nbi(), t;
    i = nbits(e[j]) - 1;
    while (j &#x3e;= 0) {
        if (i &#x3e;= k1) w = (e[j] &#x3e;&#x3e; (i - k1)) &#x26; km;
        else {
            w = (e[j] &#x26; ((1 &#x3c;&#x3c; (i + 1)) - 1)) &#x3c;&#x3c; (k1 - i);
            if (j &#x3e; 0) w |= e[j - 1] &#x3e;&#x3e; (this.DB + i - k1);
        }

        n = k;
        while ((w &#x26; 1) === 0) {
            w &#x3e;&#x3e;= 1;
            --n;
        }
        if ((i -= n) &#x3c; 0) {
            i += this.DB;
            --j;
        }
        if (is1) {	// ret == 1, don&#x27;t bother squaring or multiplying it
            g[w].copyTo(r);
            is1 = false;
        }
        else {
            while (n &#x3e; 1) {
                z.sqrTo(r, r2);
                z.sqrTo(r2, r);
                n -= 2;
            }
            if (n &#x3e; 0) z.sqrTo(r, r2); else {
                t = r;
                r = r2;
                r2 = t;
            }
            z.mulTo(r2, g[w], r);
        }

        while (j &#x3e;= 0 &#x26;&#x26; (e[j] &#x26; (1 &#x3c;&#x3c; i)) === 0) {
            z.sqrTo(r, r2);
            t = r;
            r = r2;
            r2 = t;
            if (--i &#x3c; 0) {
                i = this.DB - 1;
                --j;
            }
        }
    }
    return z.revert(r);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
var r = n1.shiftRight(k);
t = (t + 1) &#x3e;&#x3e; 1;
if (t &#x3e; lowprimes.length) t = lowprimes.length;
var a = nbi();
for (var i = 0; i &#x3c; t; ++i) {
    //Pick bases at random, instead of starting at 2
    a.fromInt(lowprimes[Math.floor(Math.random() * lowprimes.length)]);
    var y = a.<span class="apidocCodeKeywordSpan">modPow</span>(r, this);
    if (y.compareTo(BigInteger.ONE) != 0 &#x26;&#x26; y.compareTo(n1) != 0) {
        var j = 1;
        while (j++ &#x3c; k &#x26;&#x26; y.compareTo(n1) != 0) {
            y = y.modPowInt(2, this);
            if (y.compareTo(BigInteger.ONE) === 0) return false;
        }
        if (y.compareTo(n1) != 0) return false;
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.node-rsa.jsbn.prototype.modPowInt" id="apidoc.element.node-rsa.jsbn.prototype.modPowInt">
        function <span class="apidocSignatureSpan">node-rsa.jsbn.prototype.</span>modPowInt
        <span class="apidocSignatureSpan">(e, m)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function bnModPowInt(e, m) {
    var z;
    if (e &#x3c; 256 || m.isEven()) z = new Classic(m); else z = new Montgomery(m);
    return this.exp(e, z);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    for (var i = 0; i &#x3c; t; ++i) {
        //Pick bases at random, instead of starting at 2
        a.fromInt(lowprimes[Math.floor(Math.random() * lowprimes.length)]);
        var y = a.modPow(r, this);
        if (y.compareTo(BigInteger.ONE) != 0 &#x26;&#x26; y.compareTo(n1) != 0) {
            var j = 1;
            while (j++ &#x3c; k &#x26;&#x26; y.compareTo(n1) != 0) {
                y = y.<span class="apidocCodeKeywordSpan">modPowInt</span>(2, this);
                if (y.compareTo(BigInteger.ONE) === 0) return false;
            }
            if (y.compareTo(n1) != 0) return false;
        }
    }
    return true;
}
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.node-rsa.jsbn.prototype.multiply" id="apidoc.element.node-rsa.jsbn.prototype.multiply">
        function <span class="apidocSignatureSpan">node-rsa.jsbn.prototype.</span>multiply
        <span class="apidocSignatureSpan">(a)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function bnMultiply(a) {
    var r = nbi();
    this.multiplyTo(a, r);
    return r;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
if (this.p.compareTo(this.q) &#x3c;= 0) {
    var t = this.p;
    this.p = this.q;
    this.q = t;
}
var p1 = this.p.subtract(BigInteger.ONE);
var q1 = this.q.subtract(BigInteger.ONE);
var phi = p1.<span class="apidocCodeKeywordSpan">multiply</span>(q1);
if (phi.gcd(ee).compareTo(BigInteger.ONE) === 0) {
    this.n = this.p.multiply(this.q);
    if (this.n.bitLength() &#x3c; B) {
        continue;
    }
    this.d = ee.modInverse(phi);
    this.dmp1 = this.d.mod(p1);
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.node-rsa.jsbn.prototype.multiplyLowerTo" id="apidoc.element.node-rsa.jsbn.prototype.multiplyLowerTo">
        function <span class="apidocSignatureSpan">node-rsa.jsbn.prototype.</span>multiplyLowerTo
        <span class="apidocSignatureSpan">(a, n, r)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function bnpMultiplyLowerTo(a, n, r) {
    var i = Math.min(this.t + a.t, n);
    r.s = 0; // assumes a,this &#x3e;= 0
    r.t = i;
    while (i &#x3e; 0) r[--i] = 0;
    var j;
    for (j = r.t - this.t; i &#x3c; j; ++i) r[i + this.t] = this.am(0, a[i], r, i, 0, this.t);
    for (j = Math.min(a.t, n); i &#x3c; j; ++i) this.am(0, a[i], r, i, 0, n - i);
    r.clamp();
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
function barrettReduce(x) {
    x.drShiftTo(this.m.t - 1, this.r2);
    if (x.t &#x3e; this.m.t + 1) {
        x.t = this.m.t + 1;
        x.clamp();
    }
    this.mu.multiplyUpperTo(this.r2, this.m.t + 1, this.q3);
    this.m.<span class="apidocCodeKeywordSpan">multiplyLowerTo</span>(this.q3, this.m.t + 1, this.r2);
    while (x.compareTo(this.r2) &#x3c; 0) x.dAddOffset(1, this.m.t + 1);
    x.subTo(this.r2, x);
    while (x.compareTo(this.m) &#x3e;= 0) x.subTo(this.m, x);
}

//r = x^2 mod m; x != r
function barrettSqrTo(x, r) {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.node-rsa.jsbn.prototype.multiplyTo" id="apidoc.element.node-rsa.jsbn.prototype.multiplyTo">
        function <span class="apidocSignatureSpan">node-rsa.jsbn.prototype.</span>multiplyTo
        <span class="apidocSignatureSpan">(a, r)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function bnpMultiplyTo(a, r) {
    var x = this.abs(), y = a.abs();
    var i = x.t;
    r.t = i + y.t;
    while (--i &#x3e;= 0) r[i] = 0;
    for (i = 0; i &#x3c; y.t; ++i) r[i + x.t] = x.am(0, y[i], r, i, 0, x.t);
    r.s = 0;
    r.clamp();
    if (this.s != a.s) BigInteger.ZERO.subTo(r, r);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
function cRevert(x) {
    return x;
}
function cReduce(x) {
    x.divRemTo(this.m, null, x);
}
function cMulTo(x, y, r) {
    x.<span class="apidocCodeKeywordSpan">multiplyTo</span>(y, r);
    this.reduce(r);
}
function cSqrTo(x, r) {
    x.squareTo(r);
    this.reduce(r);
}
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.node-rsa.jsbn.prototype.multiplyUpperTo" id="apidoc.element.node-rsa.jsbn.prototype.multiplyUpperTo">
        function <span class="apidocSignatureSpan">node-rsa.jsbn.prototype.</span>multiplyUpperTo
        <span class="apidocSignatureSpan">(a, n, r)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function bnpMultiplyUpperTo(a, n, r) {
    --n;
    var i = r.t = this.t + a.t - n;
    r.s = 0; // assumes a,this &#x3e;= 0
    while (--i &#x3e;= 0) r[i] = 0;
    for (i = Math.max(n - this.t, 0); i &#x3c; a.t; ++i)
        r[this.t + i - n] = this.am(n - i, a[i], r, 0, 0, this.t + i - n);
    r.clamp();
    r.drShiftTo(1, r);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
//x = x mod m (HAC 14.42)
function barrettReduce(x) {
    x.drShiftTo(this.m.t - 1, this.r2);
    if (x.t &#x3e; this.m.t + 1) {
        x.t = this.m.t + 1;
        x.clamp();
    }
    this.mu.<span class="apidocCodeKeywordSpan">multiplyUpperTo</span>(this.r2, this.m.t + 1, this.q3);
    this.m.multiplyLowerTo(this.q3, this.m.t + 1, this.r2);
    while (x.compareTo(this.r2) &#x3c; 0) x.dAddOffset(1, this.m.t + 1);
    x.subTo(this.r2, x);
    while (x.compareTo(this.m) &#x3e;= 0) x.subTo(this.m, x);
}

//r = x^2 mod m; x != r
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.node-rsa.jsbn.prototype.negate" id="apidoc.element.node-rsa.jsbn.prototype.negate">
        function <span class="apidocSignatureSpan">node-rsa.jsbn.prototype.</span>negate
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function bnNegate() {
    var r = nbi();
    BigInteger.ZERO.subTo(this, r);
    return r;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
function bnpClamp() {
var c = this.s &#x26; this.DM;
while (this.t &#x3e; 0 &#x26;&#x26; this[this.t - 1] == c) --this.t;
}

// (public) return string representation in given radix
function bnToString(b) {
if (this.s &#x3c; 0) return &#x22;-&#x22; + this.<span class="apidocCodeKeywordSpan">negate</span>().toString(b);
var k;
if (b == 16) k = 4;
else if (b == 8) k = 3;
else if (b == 2) k = 1;
else if (b == 32) k = 5;
else if (b == 4) k = 2;
else return this.toRadix(b);
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.node-rsa.jsbn.prototype.not" id="apidoc.element.node-rsa.jsbn.prototype.not">
        function <span class="apidocSignatureSpan">node-rsa.jsbn.prototype.</span>not
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function bnNot() {
    var r = nbi();
    for (var i = 0; i &#x3c; this.t; ++i) r[i] = this.DM &#x26; ~this[i];
    r.t = this.t;
    r.s = ~this.s;
    return r;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.node-rsa.jsbn.prototype.or" id="apidoc.element.node-rsa.jsbn.prototype.or">
        function <span class="apidocSignatureSpan">node-rsa.jsbn.prototype.</span>or
        <span class="apidocSignatureSpan">(a)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function bnOr(a) {
    var r = nbi();
    this.bitwiseTo(a, op_or, r);
    return r;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.node-rsa.jsbn.prototype.pow" id="apidoc.element.node-rsa.jsbn.prototype.pow">
        function <span class="apidocSignatureSpan">node-rsa.jsbn.prototype.</span>pow
        <span class="apidocSignatureSpan">(e)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function bnPow(e) {
    return this.exp(e, new NullExp());
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    var size = 0;
    if ((size = buffer.length - offset) &#x3e; 0) {
        if (size &#x3e;= 4) {
            return buffer.readUInt32BE(offset);
        } else {
            var res = 0;
            for (var i = offset + size, d = 0; i &#x3e; offset; i--, d += 2) {
                res += buffer[i - 1] * Math.<span class="apidocCodeKeywordSpan">pow</span>(16, d);
            }
            return res;
        }
    } else {
        return NaN;
    }
};
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.node-rsa.jsbn.prototype.rShiftTo" id="apidoc.element.node-rsa.jsbn.prototype.rShiftTo">
        function <span class="apidocSignatureSpan">node-rsa.jsbn.prototype.</span>rShiftTo
        <span class="apidocSignatureSpan">(n, r)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function bnpRShiftTo(n, r) {
    r.s = this.s;
    var ds = Math.floor(n / this.DB);
    if (ds &#x3e;= this.t) {
        r.t = 0;
        return;
    }
    var bs = n % this.DB;
    var cbs = this.DB - bs;
    var bm = (1 &#x3c;&#x3c; bs) - 1;
    r[0] = this[ds] &#x3e;&#x3e; bs;
    for (var i = ds + 1; i &#x3c; this.t; ++i) {
        r[i - ds - 1] |= (this[i] &#x26; bm) &#x3c;&#x3c; cbs;
        r[i - ds] = this[i] &#x3e;&#x3e; bs;
    }
    if (bs &#x3e; 0) r[this.t - ds - 1] |= (this.s &#x26; bm) &#x3c;&#x3c; cbs;
    r.t = this.t - ds;
    r.clamp();
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
}
if (q != null) {
    r.drShiftTo(ys, q);
    if (ts != ms) BigInteger.ZERO.subTo(q, q);
}
r.t = ys;
r.clamp();
if (nsh &#x3e; 0) r.<span class="apidocCodeKeywordSpan">rShiftTo</span>(nsh, r);	// Denormalize remainder
if (ts &#x3c; 0) BigInteger.ZERO.subTo(r, r);
}

// (public) this mod a
function bnMod(a) {
var r = nbi();
this.abs().divRemTo(a, null, r);
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.node-rsa.jsbn.prototype.remainder" id="apidoc.element.node-rsa.jsbn.prototype.remainder">
        function <span class="apidocSignatureSpan">node-rsa.jsbn.prototype.</span>remainder
        <span class="apidocSignatureSpan">(a)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function bnRemainder(a) {
    var r = nbi();
    this.divRemTo(a, null, r);
    return r;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.node-rsa.jsbn.prototype.setBit" id="apidoc.element.node-rsa.jsbn.prototype.setBit">
        function <span class="apidocSignatureSpan">node-rsa.jsbn.prototype.</span>setBit
        <span class="apidocSignatureSpan">(n)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function bnSetBit(n) {
    return this.changeBit(n, op_or);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.node-rsa.jsbn.prototype.shiftLeft" id="apidoc.element.node-rsa.jsbn.prototype.shiftLeft">
        function <span class="apidocSignatureSpan">node-rsa.jsbn.prototype.</span>shiftLeft
        <span class="apidocSignatureSpan">(n)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function bnShiftLeft(n) {
    var r = nbi();
    if (n &#x3c; 0) this.rShiftTo(-n, r); else this.lShiftTo(n, r);
    return r;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
function bnpFromNumber(a, b) {
if (&#x22;number&#x22; == typeof b) {
    // new BigInteger(int,int,RNG)
    if (a &#x3c; 2) this.fromInt(1);
    else {
        this.fromNumber(a);
        if (!this.testBit(a - 1))	// force MSB set
            this.bitwiseTo(BigInteger.ONE.<span class="apidocCodeKeywordSpan">shiftLeft</span>(a - 1), op_or, this);
        if (this.isEven()) this.dAddOffset(1, 0); // force odd
        while (!this.isProbablePrime(b)) {
            this.dAddOffset(2, 0);
            if (this.bitLength() &#x3e; a) this.subTo(BigInteger.ONE.shiftLeft(a - 1), this);
        }
    }
} else {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.node-rsa.jsbn.prototype.shiftRight" id="apidoc.element.node-rsa.jsbn.prototype.shiftRight">
        function <span class="apidocSignatureSpan">node-rsa.jsbn.prototype.</span>shiftRight
        <span class="apidocSignatureSpan">(n)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function bnShiftRight(n) {
    var r = nbi();
    if (n &#x3c; 0) this.lShiftTo(-n, r); else this.rShiftTo(n, r);
    return r;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
}

//(protected) true if probably prime (HAC 4.24, Miller-Rabin)
function bnpMillerRabin(t) {
var n1 = this.subtract(BigInteger.ONE);
var k = n1.getLowestSetBit();
if (k &#x3c;= 0) return false;
var r = n1.<span class="apidocCodeKeywordSpan">shiftRight</span>(k);
t = (t + 1) &#x3e;&#x3e; 1;
if (t &#x3e; lowprimes.length) t = lowprimes.length;
var a = nbi();
for (var i = 0; i &#x3c; t; ++i) {
    //Pick bases at random, instead of starting at 2
    a.fromInt(lowprimes[Math.floor(Math.random() * lowprimes.length)]);
    var y = a.modPow(r, this);
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.node-rsa.jsbn.prototype.shortValue" id="apidoc.element.node-rsa.jsbn.prototype.shortValue">
        function <span class="apidocSignatureSpan">node-rsa.jsbn.prototype.</span>shortValue
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function bnShortValue() {
    return (this.t == 0) ? this.s : (this[0] &#x3c;&#x3c; 16) &#x3e;&#x3e; 16;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.node-rsa.jsbn.prototype.signum" id="apidoc.element.node-rsa.jsbn.prototype.signum">
        function <span class="apidocSignatureSpan">node-rsa.jsbn.prototype.</span>signum
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function bnSigNum() {
    if (this.s &#x3c; 0) return -1;
    else if (this.t &#x3c;= 0 || (this.t == 1 &#x26;&#x26; this[0] &#x3c;= 0)) return 0;
    else return 1;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
else if (this.t &#x3c;= 0 || (this.t == 1 &#x26;&#x26; this[0] &#x3c;= 0)) return 0;
else return 1;
}

//(protected) convert to radix string
function bnpToRadix(b) {
if (b == null) b = 10;
if (this.<span class="apidocCodeKeywordSpan">signum</span>() === 0 || b &#x3c; 2 || b &#x3e; 36) return &#x22;0&#x22;;
var cs = this.chunkSize(b);
var a = Math.pow(b, cs);
var d = nbv(a), y = nbi(), z = nbi(), r = &#x22;&#x22;;
this.divRemTo(d, y, z);
while (y.signum() &#x3e; 0) {
    r = (a + z.intValue()).toString(b).substr(1) + r;
    y.divRemTo(d, y, z);
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.node-rsa.jsbn.prototype.square" id="apidoc.element.node-rsa.jsbn.prototype.square">
        function <span class="apidocSignatureSpan">node-rsa.jsbn.prototype.</span>square
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function bnSquare() {
    var r = nbi();
    this.squareTo(r);
    return r;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.node-rsa.jsbn.prototype.squareTo" id="apidoc.element.node-rsa.jsbn.prototype.squareTo">
        function <span class="apidocSignatureSpan">node-rsa.jsbn.prototype.</span>squareTo
        <span class="apidocSignatureSpan">(r)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function bnpSquareTo(r) {
    var x = this.abs();
    var i = r.t = 2 * x.t;
    while (--i &#x3e;= 0) r[i] = 0;
    for (i = 0; i &#x3c; x.t - 1; ++i) {
        var c = x.am(i, x[i], r, 2 * i, 0, 1);
        if ((r[i + x.t] += x.am(i + 1, 2 * x[i], r, 2 * i + 1, c, x.t - i - 1)) &#x3e;= x.DV) {
            r[i + x.t] -= x.DV;
            r[i + x.t + 1] = 1;
        }
    }
    if (r.t &#x3e; 0) r[r.t - 1] += x.am(i, x[i], r, 2 * i, 0, 1);
    r.s = 0;
    r.clamp();
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    x.divRemTo(this.m, null, x);
}
function cMulTo(x, y, r) {
    x.multiplyTo(y, r);
    this.reduce(r);
}
function cSqrTo(x, r) {
    x.<span class="apidocCodeKeywordSpan">squareTo</span>(r);
    this.reduce(r);
}

Classic.prototype.convert = cConvert;
Classic.prototype.revert = cRevert;
Classic.prototype.reduce = cReduce;
Classic.prototype.mulTo = cMulTo;
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.node-rsa.jsbn.prototype.subTo" id="apidoc.element.node-rsa.jsbn.prototype.subTo">
        function <span class="apidocSignatureSpan">node-rsa.jsbn.prototype.</span>subTo
        <span class="apidocSignatureSpan">(a, r)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function bnpSubTo(a, r) {
    var i = 0, c = 0, m = Math.min(a.t, this.t);
    while (i &#x3c; m) {
        c += this[i] - a[i];
        r[i++] = c &#x26; this.DM;
        c &#x3e;&#x3e;= this.DB;
    }
    if (a.t &#x3c; this.t) {
        c -= a.s;
        while (i &#x3c; this.t) {
            c += this[i];
            r[i++] = c &#x26; this.DM;
            c &#x3e;&#x3e;= this.DB;
        }
        c += this.s;
    }
    else {
        c += this.s;
        while (i &#x3c; a.t) {
            c -= a[i];
            r[i++] = c &#x26; this.DM;
            c &#x3e;&#x3e;= this.DB;
        }
        c -= a.s;
    }
    r.s = (c &#x3c; 0) ? -1 : 0;
    if (c &#x3c; -1) r[i++] = this.DV + c;
    else if (c &#x3e; 0) r[i++] = c;
    r.t = i;
    r.clamp();
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
        if (sh &#x3e;= this.DB) sh -= this.DB;
    }
    if ((!unsigned) &#x26;&#x26; k == 8 &#x26;&#x26; (data[0] &#x26; 0x80) != 0) {
        this.s = -1;
        if (sh &#x3e; 0) this[this.t - 1] |= ((1 &#x3c;&#x3c; (this.DB - sh)) - 1) &#x3c;&#x3c; sh;
    }
    this.clamp();
    if (mi) BigInteger.ZERO.<span class="apidocCodeKeywordSpan">subTo</span>(this, this);
}

function bnpFromByteArray(a, unsigned) {
    this.fromString(a, 256, unsigned)
}

function bnpFromBuffer(a) {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.node-rsa.jsbn.prototype.subtract" id="apidoc.element.node-rsa.jsbn.prototype.subtract">
        function <span class="apidocSignatureSpan">node-rsa.jsbn.prototype.</span>subtract
        <span class="apidocSignatureSpan">(a)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function bnSubtract(a) {
    var r = nbi();
    this.subTo(a, r);
    return r;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
        else {
            v.subTo(u, v);
            if (ac) c.subTo(a, c);
            d.subTo(b, d);
        }
    }
    if (v.compareTo(BigInteger.ONE) != 0) return BigInteger.ZERO;
    if (d.compareTo(m) &#x3e;= 0) return d.<span class="apidocCodeKeywordSpan">subtract</span>(m);
    if (d.signum() &#x3c; 0) d.addTo(m, d); else return d;
    if (d.signum() &#x3c; 0) return d.add(m); else return d;
}

var lowprimes = [2, 3, 5, 7, 11, 13, 17, 19, 23, 29, 31, 37, 41, 43, 47, 53, 59, 61, 67, 71, 73, 79, 83, 89, 97, 101, 103, 107,
109, 113, 127, 131, 137, 139, 149, 151, 157, 163, 167, 173, 179, 181, 191, 193, 197, 199, 211, 223, 227, 229, 233, 239, 241, 251
, 257, 263, 269, 271, 277, 281, 283, 293, 307, 311, 313, 317, 331, 337, 347, 349, 353, 359, 367, 373, 379, 383, 389, 397, 401, 409
, 419, 421, 431, 433, 439, 443, 449, 457, 461, 463, 467, 479, 487, 491, 499, 503, 509, 521, 523, 541, 547, 557, 563, 569, 571, 577
, 587, 593, 599, 601, 607, 613, 617, 619, 631, 641, 643, 647, 653, 659, 661, 673, 677, 683, 691, 701, 709, 719, 727, 733, 739, 743
, 751, 757, 761, 769, 773, 787, 797, 809, 811, 821, 823, 827, 829, 839, 853, 857, 859, 863, 877, 881, 883, 887, 907, 911, 919, 929
, 937, 941, 947, 953, 967, 971, 977, 983, 991, 997];
var lplim = (1 &#x3c;&#x3c; 26) / lowprimes[lowprimes.length - 1];
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.node-rsa.jsbn.prototype.testBit" id="apidoc.element.node-rsa.jsbn.prototype.testBit">
        function <span class="apidocSignatureSpan">node-rsa.jsbn.prototype.</span>testBit
        <span class="apidocSignatureSpan">(n)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function bnTestBit(n) {
    var j = Math.floor(n / this.DB);
    if (j &#x3e;= this.t) return (this.s != 0);
    return ((this[j] &#x26; (1 &#x3c;&#x3c; (n % this.DB))) != 0);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
//(protected) alternate constructor
function bnpFromNumber(a, b) {
if (&#x22;number&#x22; == typeof b) {
    // new BigInteger(int,int,RNG)
    if (a &#x3c; 2) this.fromInt(1);
    else {
        this.fromNumber(a);
        if (!this.<span class="apidocCodeKeywordSpan">testBit</span>(a - 1))	// force MSB set
            this.bitwiseTo(BigInteger.ONE.shiftLeft(a - 1), op_or, this);
        if (this.isEven()) this.dAddOffset(1, 0); // force odd
        while (!this.isProbablePrime(b)) {
            this.dAddOffset(2, 0);
            if (this.bitLength() &#x3e; a) this.subTo(BigInteger.ONE.shiftLeft(a - 1), this);
        }
    }
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.node-rsa.jsbn.prototype.toBuffer" id="apidoc.element.node-rsa.jsbn.prototype.toBuffer">
        function <span class="apidocSignatureSpan">node-rsa.jsbn.prototype.</span>toBuffer
        <span class="apidocSignatureSpan">(trimOrSize)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function bnToBuffer(trimOrSize) {
    var res = new Buffer(this.toByteArray());
    if (trimOrSize === true &#x26;&#x26; res[0] === 0) {
        res = res.slice(1);
    } else if (_.isNumber(trimOrSize)) {
        if (res.length &#x3e; trimOrSize) {
            for (var i = 0; i &#x3c; res.length - trimOrSize; i++) {
                if (res[i] !== 0) {
                    return null;
                }
            }
            return res.slice(res.length - trimOrSize);
        } else if (res.length &#x3c; trimOrSize) {
            var padded = new Buffer(trimOrSize);
            padded.fill(0, 0, trimOrSize - res.length);
            res.copy(padded, trimOrSize - res.length);
            return padded;
        }
    }
    return res;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    /* Type 1: zeros padding for private key encrypt */
    m = new BigInteger(pkcs1Scheme.encPad(buffer, {type: 1}));
    c = keyPair.$doPrivate(m);
} else {
    m = new BigInteger(keyPair.encryptionScheme.encPad(buffer));
    c = keyPair.$doPublic(m);
}
return c.<span class="apidocCodeKeywordSpan">toBuffer</span>(keyPair.encryptedDataLength);
        },

        decrypt: function (buffer, usePublic) {
var m, c = new BigInteger(buffer);

if (usePublic) {
    m = keyPair.$doPublic(c);
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.node-rsa.jsbn.prototype.toByteArray" id="apidoc.element.node-rsa.jsbn.prototype.toByteArray">
        function <span class="apidocSignatureSpan">node-rsa.jsbn.prototype.</span>toByteArray
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function bnToByteArray() {
    var i = this.t, r = new Array();
    r[0] = this.s;
    var p = this.DB - (i * this.DB) % 8, d, k = 0;
    if (i-- &#x3e; 0) {
        if (p &#x3c; this.DB &#x26;&#x26; (d = this[i] &#x3e;&#x3e; p) != (this.s &#x26; this.DM) &#x3e;&#x3e; p)
            r[k++] = d | (this.s &#x3c;&#x3c; (this.DB - p));
        while (i &#x3e;= 0) {
            if (p &#x3c; 8) {
                d = (this[i] &#x26; ((1 &#x3c;&#x3c; p) - 1)) &#x3c;&#x3c; (8 - p);
                d |= this[--i] &#x3e;&#x3e; (p += this.DB - 8);
            }
            else {
                d = (this[i] &#x3e;&#x3e; (p -= 8)) &#x26; 0xff;
                if (p &#x3c;= 0) {
                    p += this.DB;
                    --i;
                }
            }
            if ((d &#x26; 0x80) != 0) d |= -256;
            if (k === 0 &#x26;&#x26; (this.s &#x26; 0x80) != (d &#x26; 0x80)) ++k;
            if (k &#x3e; 0 || d != this.s) r[k++] = d;
        }
    }
    return r;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

/**
 * return Buffer object
 * @param trim {boolean} slice buffer if first element == 0
 * @returns {Buffer}
 */
function bnToBuffer(trimOrSize) {
var res = new Buffer(this.<span class="apidocCodeKeywordSpan">toByteArray</span>());
if (trimOrSize === true &#x26;&#x26; res[0] === 0) {
    res = res.slice(1);
} else if (_.isNumber(trimOrSize)) {
    if (res.length &#x3e; trimOrSize) {
        for (var i = 0; i &#x3c; res.length - trimOrSize; i++) {
            if (res[i] !== 0) {
                return null;
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.node-rsa.jsbn.prototype.toRadix" id="apidoc.element.node-rsa.jsbn.prototype.toRadix">
        function <span class="apidocSignatureSpan">node-rsa.jsbn.prototype.</span>toRadix
        <span class="apidocSignatureSpan">(b)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function bnpToRadix(b) {
    if (b == null) b = 10;
    if (this.signum() === 0 || b &#x3c; 2 || b &#x3e; 36) return &#x22;0&#x22;;
    var cs = this.chunkSize(b);
    var a = Math.pow(b, cs);
    var d = nbv(a), y = nbi(), z = nbi(), r = &#x22;&#x22;;
    this.divRemTo(d, y, z);
    while (y.signum() &#x3e; 0) {
        r = (a + z.intValue()).toString(b).substr(1) + r;
        y.divRemTo(d, y, z);
    }
    return z.intValue().toString(b) + r;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
if (this.s &#x3c; 0) return &#x22;-&#x22; + this.negate().toString(b);
var k;
if (b == 16) k = 4;
else if (b == 8) k = 3;
else if (b == 2) k = 1;
else if (b == 32) k = 5;
else if (b == 4) k = 2;
else return this.<span class="apidocCodeKeywordSpan">toRadix</span>(b);
var km = (1 &#x3c;&#x3c; k) - 1, d, m = false, r = &#x22;&#x22;, i = this.t;
var p = this.DB - (i * this.DB) % k;
if (i-- &#x3e; 0) {
    if (p &#x3c; this.DB &#x26;&#x26; (d = this[i] &#x3e;&#x3e; p) &#x3e; 0) {
        m = true;
        r = int2char(d);
    }
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.node-rsa.jsbn.prototype.toString" id="apidoc.element.node-rsa.jsbn.prototype.toString">
        function <span class="apidocSignatureSpan">node-rsa.jsbn.prototype.</span>toString
        <span class="apidocSignatureSpan">(b)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function bnToString(b) {
    if (this.s &#x3c; 0) return &#x22;-&#x22; + this.negate().toString(b);
    var k;
    if (b == 16) k = 4;
    else if (b == 8) k = 3;
    else if (b == 2) k = 1;
    else if (b == 32) k = 5;
    else if (b == 4) k = 2;
    else return this.toRadix(b);
    var km = (1 &#x3c;&#x3c; k) - 1, d, m = false, r = &#x22;&#x22;, i = this.t;
    var p = this.DB - (i * this.DB) % k;
    if (i-- &#x3e; 0) {
        if (p &#x3c; this.DB &#x26;&#x26; (d = this[i] &#x3e;&#x3e; p) &#x3e; 0) {
            m = true;
            r = int2char(d);
        }
        while (i &#x3e;= 0) {
            if (p &#x3c; k) {
                d = (this[i] &#x26; ((1 &#x3c;&#x3c; p) - 1)) &#x3c;&#x3c; (k - p);
                d |= this[--i] &#x3e;&#x3e; (p += this.DB - k);
            }
            else {
                d = (this[i] &#x3e;&#x3e; (p -= k)) &#x26; km;
                if (p &#x3c;= 0) {
                    p += this.DB;
                    --i;
                }
            }
            if (d &#x3e; 0) m = true;
            if (m) r += int2char(d);
        }
    }
    return m ? r : &#x22;0&#x22;;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    bits = bits || 2048;
    exp = exp || 65537;

    if (bits % 8 !== 0) {
        throw Error(&#x27;Key size must be a multiple of 8.&#x27;);
    }

    this.keyPair.generate(bits, exp.<span class="apidocCodeKeywordSpan">toString</span>(16));
    this.$cache = {};
    return this;
};

/**
 * Importing key
 * @param keyData {string|buffer|Object}
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.node-rsa.jsbn.prototype.xor" id="apidoc.element.node-rsa.jsbn.prototype.xor">
        function <span class="apidocSignatureSpan">node-rsa.jsbn.prototype.</span>xor
        <span class="apidocSignatureSpan">(a)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function bnXor(a) {
    var r = nbi();
    this.bitwiseTo(a, op_xor, r);
    return r;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>














</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.node-rsa.oaep" id="apidoc.module.node-rsa.oaep">module node-rsa.oaep</a></h1>






    <h2>
        <a href="#apidoc.element.node-rsa.oaep.eme_oaep_mgf1" id="apidoc.element.node-rsa.oaep.eme_oaep_mgf1">
        function <span class="apidocSignatureSpan">node-rsa.oaep.</span>eme_oaep_mgf1
        <span class="apidocSignatureSpan">(seed, maskLength, hashFunction)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">eme_oaep_mgf1 = function (seed, maskLength, hashFunction) {
    hashFunction = hashFunction || DEFAULT_HASH_FUNCTION;
    var hLen = module.exports.digestLength[hashFunction];
    var count = Math.ceil(maskLength / hLen);
    var T = new Buffer(hLen * count);
    var c = new Buffer(4);
    for (var i = 0; i &#x3c; count; ++i) {
        var hash = crypt.createHash(hashFunction);
        hash.update(seed);
        c.writeUInt32BE(i, 0);
        hash.update(c);
        hash.digest().copy(T, i * hLen);
    }
    return T.slice(0, maskLength);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.node-rsa.oaep.makeScheme" id="apidoc.element.node-rsa.oaep.makeScheme">
        function <span class="apidocSignatureSpan">node-rsa.oaep.</span>makeScheme
        <span class="apidocSignatureSpan">(key, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">makeScheme = function (key, options) {
    function Scheme(key, options) {
        this.key = key;
        this.options = options;
    }

    Scheme.prototype.maxMessageLength = function () {
        return this.key.encryptedDataLength - 2 * module.exports.digestLength[this.options.encryptionSchemeOptions.hash || DEFAULT_HASH_FUNCTION
] - 2;
    };

<span class="apidocCodeCommentSpan">    /**
     * Pad input
     * alg: PKCS1_OAEP
     *
     * https://tools.ietf.org/html/rfc3447#section-7.1.1
     */
</span>    Scheme.prototype.encPad = function (buffer) {
        var hash = this.options.encryptionSchemeOptions.hash || DEFAULT_HASH_FUNCTION;
        var mgf = this.options.encryptionSchemeOptions.mgf || module.exports.eme_oaep_mgf1;
        var label = this.options.encryptionSchemeOptions.label || new Buffer(0);
        var emLen = this.key.encryptedDataLength;

        var hLen = module.exports.digestLength[hash];

        // Make sure we can put message into an encoded message of emLen bytes
        if (buffer.length &#x3e; emLen - 2 * hLen - 2) {
            throw new Error(&#x22;Message is too long to encode into an encoded message with a length of &#x22; + emLen + &#x22; bytes, increase
&#x22; +
            &#x22;emLen to fix this error (minimum value for given parameters and options: &#x22; + (emLen - 2 * hLen - 2) + &#x22;)&#x22;);
        }

        var lHash = crypt.createHash(hash);
        lHash.update(label);
        lHash = lHash.digest();

        var PS = new Buffer(emLen - buffer.length - 2 * hLen - 1); // Padding &#x22;String&#x22;
        PS.fill(0); // Fill the buffer with octets of 0
        PS[PS.length - 1] = 1;

        var DB = Buffer.concat([lHash, PS, buffer]);
        var seed = crypt.randomBytes(hLen);

        // mask = dbMask
        var mask = mgf(seed, DB.length, hash);
        // XOR DB and dbMask together.
        for (var i = 0; i &#x3c; DB.length; i++) {
            DB[i] ^= mask[i];
        }
        // DB = maskedDB

        // mask = seedMask
        mask = mgf(DB, hLen, hash);
        // XOR seed and seedMask together.
        for (i = 0; i &#x3c; seed.length; i++) {
            seed[i] ^= mask[i];
        }
        // seed = maskedSeed

        var em = new Buffer(1 + seed.length + DB.length);
        em[0] = 0;
        seed.copy(em, 1);
        DB.copy(em, 1 + seed.length);

        return em;
    };

    /**
     * Unpad input
     * alg: PKCS1_OAEP
     *
     * Note: This method works within the buffer given and modifies the values. It also returns a slice of the EM as the return
Message.
     * If the implementation requires that the EM parameter be unmodified then the implementation should pass in a clone of the
EM buffer.
     *
     * https://tools.ietf.org/html/rfc3447#section-7.1.2
     */
    Scheme.prototype.encUnPad = function (buffer) {
        var hash = this.options.encryptionSchemeOptions.hash || DEFAULT_HASH_FUNCTION;
        var mgf = this.options.encryptionSchemeOptions.mgf || module.exports.eme_oaep_mgf1;
        var label = this.options.encryptionSchemeOptions.label || new Buffer(0);

        var hLen = module.exports.digestLength[hash];

        // Check to see if buffer is a properly encoded OAEP message
        if (buffer.length &#x3c; 2 * hLen + 2) {
            throw new Error(&#x22;Error decoding message, the supplied message is not long enough to be a valid OAEP encoded message&#x22;);
        }

        var seed = buffer.slice(1, hLen + 1);	// seed = maskedSeed
        var DB = buffer.slice(1 + hLen);		// DB = maskedDB

        var mask = mgf(DB, hLen, hash); // seedMask
        // XOR maskedSeed and seedMask together to get the original seed.
        for (var i = 0; i &#x3c; seed.length; i++) {
            seed[i] ^= mask[i];
        }

        mask = mgf(seed, DB.length, hash); // dbMask
        // XOR DB and dbMask together to get the original data block.
        for (i = 0; i &#x3c; DB.length; i++) {
            DB[i] ^= mask[i];
        }

        var lHash = crypt.createHash(hash);
        lHash.update(label);
        lHash = lHash.digest();

        var lHashEM = DB.slice(0, hLen);
        if (lHashEM.toString(&#x22;hex&#x22;) != lHash.toString(&#x22;hex&#x22;)) {
            throw new Error(&#x22;Error decod ...</pre></li>
    <li>example usage<pre class="apidocCodePre">...


var crypto = require(&#x27;crypto&#x27;);
var constants = require(&#x27;constants&#x27;);
var schemes = require(&#x27;../schemes/schemes.js&#x27;);

module.exports = function (keyPair, options) {
var pkcs1Scheme = schemes.pkcs1.<span class="apidocCodeKeywordSpan">makeScheme</span>(keyPair, options);

return {
    encrypt: function (buffer, usePrivate) {
        if (usePrivate) {
            var padding = constants.RSA_PKCS1_PADDING;
            if (options.encryptionSchemeOptions &#x26;&#x26; options.encryptionSchemeOptions.padding) {
                padding = options.encryptionSchemeOptions.padding;
...</pre></li>
    </ul>




</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.node-rsa.pkcs1" id="apidoc.module.node-rsa.pkcs1">module node-rsa.pkcs1</a></h1>


    <h2>
        <a href="#apidoc.element.node-rsa.pkcs1.autoImport" id="apidoc.element.node-rsa.pkcs1.autoImport">
        function <span class="apidocSignatureSpan">node-rsa.pkcs1.</span>autoImport
        <span class="apidocSignatureSpan">(key, data)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">autoImport = function (key, data) {
    if (/^\s*-----BEGIN RSA PRIVATE KEY-----\s*(?=(([A-Za-z0-9+/=]+\s*)+))\1-----END RSA PRIVATE KEY-----\s*$/g.test(data)) {
        module.exports.privateImport(key, data);
        return true;
    }

    if (/^\s*-----BEGIN RSA PUBLIC KEY-----\s*(?=(([A-Za-z0-9+/=]+\s*)+))\1-----END RSA PUBLIC KEY-----\s*$/g.test(data)) {
        module.exports.publicImport(key, data);
        return true;
    }

    return false;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    isPublicImport: function (format) {
        return module.exports[format] &#x26;&#x26; typeof module.exports[format].publicImport === &#x27;function&#x27;;
    },

    detectAndImport: function (key, data, format) {
        if (format === undefined) {
for (var scheme in module.exports) {
    if (typeof module.exports[scheme].autoImport === &#x27;function&#x27; &#x26;&#x26; module.exports[scheme].<span class="apidocCodeKeywordSpan
">autoImport</span>(key, data)) {
        return true;
    }
}
        } else if (format) {
var fmt = formatParse(format);

if (module.exports[fmt.scheme]) {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.node-rsa.pkcs1.privateExport" id="apidoc.element.node-rsa.pkcs1.privateExport">
        function <span class="apidocSignatureSpan">node-rsa.pkcs1.</span>privateExport
        <span class="apidocSignatureSpan">(key, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">privateExport = function (key, options) {
    options = options || {};

    var n = key.n.toBuffer();
    var d = key.d.toBuffer();
    var p = key.p.toBuffer();
    var q = key.q.toBuffer();
    var dmp1 = key.dmp1.toBuffer();
    var dmq1 = key.dmq1.toBuffer();
    var coeff = key.coeff.toBuffer();

    var length = n.length + d.length + p.length + q.length + dmp1.length + dmq1.length + coeff.length + 512; // magic
    var writer = new ber.Writer({size: length});

    writer.startSequence();
    writer.writeInt(0);
    writer.writeBuffer(n, 2);
    writer.writeInt(key.e);
    writer.writeBuffer(d, 2);
    writer.writeBuffer(p, 2);
    writer.writeBuffer(q, 2);
    writer.writeBuffer(dmp1, 2);
    writer.writeBuffer(dmq1, 2);
    writer.writeBuffer(coeff, 2);
    writer.endSequence();

    if (options.type === &#x27;der&#x27;) {
        return writer.buffer;
    } else {
        return &#x27;-----BEGIN RSA PRIVATE KEY-----\n&#x27; + utils.linebrk(writer.buffer.toString(&#x27;base64&#x27;), 64) + &#x27;\n-----END RSA PRIVATE
 KEY-----&#x27;;
    }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
var fmt = formatParse(format);

if (module.exports[fmt.scheme]) {
    if (fmt.keyType === &#x27;private&#x27;) {
        if (!key.isPrivate()) {
            throw Error(&#x22;This is not private key&#x22;);
        }
        return module.exports[fmt.scheme].<span class="apidocCodeKeywordSpan">privateExport</span>(key, fmt.keyOpt);
    } else {
        if (!key.isPublic()) {
            throw Error(&#x22;This is not public key&#x22;);
        }
        return module.exports[fmt.scheme].publicExport(key, fmt.keyOpt);
    }
} else {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.node-rsa.pkcs1.privateImport" id="apidoc.element.node-rsa.pkcs1.privateImport">
        function <span class="apidocSignatureSpan">node-rsa.pkcs1.</span>privateImport
        <span class="apidocSignatureSpan">(key, data, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">privateImport = function (key, data, options) {
    options = options || {};
    var buffer;

    if (options.type !== &#x27;der&#x27;) {
        if (Buffer.isBuffer(data)) {
            data = data.toString(&#x27;utf8&#x27;);
        }

        if (_.isString(data)) {
            var pem = data.replace(&#x27;-----BEGIN RSA PRIVATE KEY-----&#x27;, &#x27;&#x27;)
                .replace(&#x27;-----END RSA PRIVATE KEY-----&#x27;, &#x27;&#x27;)
                .replace(/\s+|\n\r|\n|\r$/gm, &#x27;&#x27;);
            buffer = new Buffer(pem, &#x27;base64&#x27;);
        } else {
            throw Error(&#x27;Unsupported key format&#x27;);
        }
    } else if (Buffer.isBuffer(data)) {
        buffer = data;
    } else {
        throw Error(&#x27;Unsupported key format&#x27;);
    }

    var reader = new ber.Reader(buffer);
    reader.readSequence();
    reader.readString(2, true); // just zero
    key.setPrivate(
        reader.readString(2, true),  // modulus
        reader.readString(2, true),  // publicExponent
        reader.readString(2, true),  // privateExponent
        reader.readString(2, true),  // prime1
        reader.readString(2, true),  // prime2
        reader.readString(2, true),  // exponent1 -- d mod (p1)
        reader.readString(2, true),  // exponent2 -- d mod (q-1)
        reader.readString(2, true)   // coefficient -- (inverse of q) mod p
    );
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
 * Trying autodetect and import key
 * @param key
 * @param data
 */
autoImport: function (key, data) {
    if (data.n &#x26;&#x26; data.e) {
        if (data.d &#x26;&#x26; data.p &#x26;&#x26; data.q &#x26;&#x26; data.dmp1 &#x26;&#x26; data.dmq1 &#x26;&#x26; data.coeff
) {
            module.exports.<span class="apidocCodeKeywordSpan">privateImport</span>(key, data);
            return true;
        } else {
            module.exports.publicImport(key, data);
            return true;
        }
    }
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.node-rsa.pkcs1.publicExport" id="apidoc.element.node-rsa.pkcs1.publicExport">
        function <span class="apidocSignatureSpan">node-rsa.pkcs1.</span>publicExport
        <span class="apidocSignatureSpan">(key, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">publicExport = function (key, options) {
    options = options || {};

    var n = key.n.toBuffer();
    var length = n.length + 512; // magic

    var bodyWriter = new ber.Writer({size: length});
    bodyWriter.startSequence();
    bodyWriter.writeBuffer(n, 2);
    bodyWriter.writeInt(key.e);
    bodyWriter.endSequence();

    if (options.type === &#x27;der&#x27;) {
        return bodyWriter.buffer;
    } else {
        return &#x27;-----BEGIN RSA PUBLIC KEY-----\n&#x27; + utils.linebrk(bodyWriter.buffer.toString(&#x27;base64&#x27;), 64) + &#x27;\n-----END RSA PUBLIC
 KEY-----&#x27;;
    }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
                        throw Error(&#x22;This is not private key&#x22;);
                    }
                    return module.exports[fmt.scheme].privateExport(key, fmt.keyOpt);
                } else {
                    if (!key.isPublic()) {
                        throw Error(&#x22;This is not public key&#x22;);
                    }
                    return module.exports[fmt.scheme].<span class="apidocCodeKeywordSpan">publicExport</span>(key, fmt.keyOpt);
                }
            } else {
                throw Error(&#x27;Unsupported key format&#x27;);
            }
        }
    }
};
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.node-rsa.pkcs1.publicImport" id="apidoc.element.node-rsa.pkcs1.publicImport">
        function <span class="apidocSignatureSpan">node-rsa.pkcs1.</span>publicImport
        <span class="apidocSignatureSpan">(key, data, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">publicImport = function (key, data, options) {
    options = options || {};
    var buffer;

    if (options.type !== &#x27;der&#x27;) {
        if (Buffer.isBuffer(data)) {
            data = data.toString(&#x27;utf8&#x27;);
        }

        if (_.isString(data)) {
            var pem = data.replace(&#x27;-----BEGIN RSA PUBLIC KEY-----&#x27;, &#x27;&#x27;)
                .replace(&#x27;-----END RSA PUBLIC KEY-----&#x27;, &#x27;&#x27;)
                .replace(/\s+|\n\r|\n|\r$/gm, &#x27;&#x27;);
            buffer = new Buffer(pem, &#x27;base64&#x27;);
        }
    } else if (Buffer.isBuffer(data)) {
        buffer = data;
    } else {
        throw Error(&#x27;Unsupported key format&#x27;);
    }

    var body = new ber.Reader(buffer);
    body.readSequence();
    key.setPublic(
        body.readString(0x02, true), // modulus
        body.readString(0x02, true)  // publicExponent
    );
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
     */
    autoImport: function (key, data) {
        if (data.n &#x26;&#x26; data.e) {
            if (data.d &#x26;&#x26; data.p &#x26;&#x26; data.q &#x26;&#x26; data.dmp1 &#x26;&#x26; data.dmq1 &#x26;&#x26; data.coeff
) {
                module.exports.privateImport(key, data);
                return true;
            } else {
                module.exports.<span class="apidocCodeKeywordSpan">publicImport</span>(key, data);
                return true;
            }
        }

        return false;
    }
};
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.node-rsa.pkcs8" id="apidoc.module.node-rsa.pkcs8">module node-rsa.pkcs8</a></h1>


    <h2>
        <a href="#apidoc.element.node-rsa.pkcs8.autoImport" id="apidoc.element.node-rsa.pkcs8.autoImport">
        function <span class="apidocSignatureSpan">node-rsa.pkcs8.</span>autoImport
        <span class="apidocSignatureSpan">(key, data)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">autoImport = function (key, data) {
    if (/^\s*-----BEGIN PRIVATE KEY-----\s*(?=(([A-Za-z0-9+/=]+\s*)+))\1-----END PRIVATE KEY-----\s*$/g.test(data)) {
        module.exports.privateImport(key, data);
        return true;
    }

    if (/^\s*-----BEGIN PUBLIC KEY-----\s*(?=(([A-Za-z0-9+/=]+\s*)+))\1-----END PUBLIC KEY-----\s*$/g.test(data)) {
        module.exports.publicImport(key, data);
        return true;
    }

    return false;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    isPublicImport: function (format) {
        return module.exports[format] &#x26;&#x26; typeof module.exports[format].publicImport === &#x27;function&#x27;;
    },

    detectAndImport: function (key, data, format) {
        if (format === undefined) {
for (var scheme in module.exports) {
    if (typeof module.exports[scheme].autoImport === &#x27;function&#x27; &#x26;&#x26; module.exports[scheme].<span class="apidocCodeKeywordSpan
">autoImport</span>(key, data)) {
        return true;
    }
}
        } else if (format) {
var fmt = formatParse(format);

if (module.exports[fmt.scheme]) {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.node-rsa.pkcs8.privateExport" id="apidoc.element.node-rsa.pkcs8.privateExport">
        function <span class="apidocSignatureSpan">node-rsa.pkcs8.</span>privateExport
        <span class="apidocSignatureSpan">(key, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">privateExport = function (key, options) {
    options = options || {};

    var n = key.n.toBuffer();
    var d = key.d.toBuffer();
    var p = key.p.toBuffer();
    var q = key.q.toBuffer();
    var dmp1 = key.dmp1.toBuffer();
    var dmq1 = key.dmq1.toBuffer();
    var coeff = key.coeff.toBuffer();

    var length = n.length + d.length + p.length + q.length + dmp1.length + dmq1.length + coeff.length + 512; // magic
    var bodyWriter = new ber.Writer({size: length});

    bodyWriter.startSequence();
    bodyWriter.writeInt(0);
    bodyWriter.writeBuffer(n, 2);
    bodyWriter.writeInt(key.e);
    bodyWriter.writeBuffer(d, 2);
    bodyWriter.writeBuffer(p, 2);
    bodyWriter.writeBuffer(q, 2);
    bodyWriter.writeBuffer(dmp1, 2);
    bodyWriter.writeBuffer(dmq1, 2);
    bodyWriter.writeBuffer(coeff, 2);
    bodyWriter.endSequence();

    var writer = new ber.Writer({size: length});
    writer.startSequence();
    writer.writeInt(0);
    writer.startSequence();
    writer.writeOID(PUBLIC_RSA_OID);
    writer.writeNull();
    writer.endSequence();
    writer.writeBuffer(bodyWriter.buffer, 4);
    writer.endSequence();

    if (options.type === &#x27;der&#x27;) {
        return writer.buffer;
    } else {
        return &#x27;-----BEGIN PRIVATE KEY-----\n&#x27; + utils.linebrk(writer.buffer.toString(&#x27;base64&#x27;), 64) + &#x27;\n-----END PRIVATE KEY-----&#x27;;
    }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
var fmt = formatParse(format);

if (module.exports[fmt.scheme]) {
    if (fmt.keyType === &#x27;private&#x27;) {
        if (!key.isPrivate()) {
            throw Error(&#x22;This is not private key&#x22;);
        }
        return module.exports[fmt.scheme].<span class="apidocCodeKeywordSpan">privateExport</span>(key, fmt.keyOpt);
    } else {
        if (!key.isPublic()) {
            throw Error(&#x22;This is not public key&#x22;);
        }
        return module.exports[fmt.scheme].publicExport(key, fmt.keyOpt);
    }
} else {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.node-rsa.pkcs8.privateImport" id="apidoc.element.node-rsa.pkcs8.privateImport">
        function <span class="apidocSignatureSpan">node-rsa.pkcs8.</span>privateImport
        <span class="apidocSignatureSpan">(key, data, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">privateImport = function (key, data, options) {
    options = options || {};
    var buffer;

    if (options.type !== &#x27;der&#x27;) {
        if (Buffer.isBuffer(data)) {
            data = data.toString(&#x27;utf8&#x27;);
        }

        if (_.isString(data)) {
            var pem = data.replace(&#x27;-----BEGIN PRIVATE KEY-----&#x27;, &#x27;&#x27;)
                .replace(&#x27;-----END PRIVATE KEY-----&#x27;, &#x27;&#x27;)
                .replace(/\s+|\n\r|\n|\r$/gm, &#x27;&#x27;);
            buffer = new Buffer(pem, &#x27;base64&#x27;);
        } else {
            throw Error(&#x27;Unsupported key format&#x27;);
        }
    } else if (Buffer.isBuffer(data)) {
        buffer = data;
    } else {
        throw Error(&#x27;Unsupported key format&#x27;);
    }

    var reader = new ber.Reader(buffer);
    reader.readSequence();
    reader.readInt(0);
    var header = new ber.Reader(reader.readString(0x30, true));

    if (header.readOID(0x06, true) !== PUBLIC_RSA_OID) {
        throw Error(&#x27;Invalid Public key format&#x27;);
    }

    var body = new ber.Reader(reader.readString(0x04, true));
    body.readSequence();
    body.readString(2, true); // just zero
    key.setPrivate(
        body.readString(2, true),  // modulus
        body.readString(2, true),  // publicExponent
        body.readString(2, true),  // privateExponent
        body.readString(2, true),  // prime1
        body.readString(2, true),  // prime2
        body.readString(2, true),  // exponent1 -- d mod (p1)
        body.readString(2, true),  // exponent2 -- d mod (q-1)
        body.readString(2, true)   // coefficient -- (inverse of q) mod p
    );
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
 * Trying autodetect and import key
 * @param key
 * @param data
 */
autoImport: function (key, data) {
    if (data.n &#x26;&#x26; data.e) {
        if (data.d &#x26;&#x26; data.p &#x26;&#x26; data.q &#x26;&#x26; data.dmp1 &#x26;&#x26; data.dmq1 &#x26;&#x26; data.coeff
) {
            module.exports.<span class="apidocCodeKeywordSpan">privateImport</span>(key, data);
            return true;
        } else {
            module.exports.publicImport(key, data);
            return true;
        }
    }
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.node-rsa.pkcs8.publicExport" id="apidoc.element.node-rsa.pkcs8.publicExport">
        function <span class="apidocSignatureSpan">node-rsa.pkcs8.</span>publicExport
        <span class="apidocSignatureSpan">(key, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">publicExport = function (key, options) {
    options = options || {};

    var n = key.n.toBuffer();
    var length = n.length + 512; // magic

    var bodyWriter = new ber.Writer({size: length});
    bodyWriter.writeByte(0);
    bodyWriter.startSequence();
    bodyWriter.writeBuffer(n, 2);
    bodyWriter.writeInt(key.e);
    bodyWriter.endSequence();

    var writer = new ber.Writer({size: length});
    writer.startSequence();
    writer.startSequence();
    writer.writeOID(PUBLIC_RSA_OID);
    writer.writeNull();
    writer.endSequence();
    writer.writeBuffer(bodyWriter.buffer, 3);
    writer.endSequence();

    if (options.type === &#x27;der&#x27;) {
        return writer.buffer;
    } else {
        return &#x27;-----BEGIN PUBLIC KEY-----\n&#x27; + utils.linebrk(writer.buffer.toString(&#x27;base64&#x27;), 64) + &#x27;\n-----END PUBLIC KEY-----&#x27;;
    }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
                        throw Error(&#x22;This is not private key&#x22;);
                    }
                    return module.exports[fmt.scheme].privateExport(key, fmt.keyOpt);
                } else {
                    if (!key.isPublic()) {
                        throw Error(&#x22;This is not public key&#x22;);
                    }
                    return module.exports[fmt.scheme].<span class="apidocCodeKeywordSpan">publicExport</span>(key, fmt.keyOpt);
                }
            } else {
                throw Error(&#x27;Unsupported key format&#x27;);
            }
        }
    }
};
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.node-rsa.pkcs8.publicImport" id="apidoc.element.node-rsa.pkcs8.publicImport">
        function <span class="apidocSignatureSpan">node-rsa.pkcs8.</span>publicImport
        <span class="apidocSignatureSpan">(key, data, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">publicImport = function (key, data, options) {
    options = options || {};
    var buffer;

    if (options.type !== &#x27;der&#x27;) {
        if (Buffer.isBuffer(data)) {
            data = data.toString(&#x27;utf8&#x27;);
        }

        if (_.isString(data)) {
            var pem = data.replace(&#x27;-----BEGIN PUBLIC KEY-----&#x27;, &#x27;&#x27;)
                .replace(&#x27;-----END PUBLIC KEY-----&#x27;, &#x27;&#x27;)
                .replace(/\s+|\n\r|\n|\r$/gm, &#x27;&#x27;);
            buffer = new Buffer(pem, &#x27;base64&#x27;);
        }
    } else if (Buffer.isBuffer(data)) {
        buffer = data;
    } else {
        throw Error(&#x27;Unsupported key format&#x27;);
    }

    var reader = new ber.Reader(buffer);
    reader.readSequence();
    var header = new ber.Reader(reader.readString(0x30, true));

    if (header.readOID(0x06, true) !== PUBLIC_RSA_OID) {
        throw Error(&#x27;Invalid Public key format&#x27;);
    }

    var body = new ber.Reader(reader.readString(0x03, true));
    body.readByte();
    body.readSequence();
    key.setPublic(
        body.readString(0x02, true), // modulus
        body.readString(0x02, true)  // publicExponent
    );
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
     */
    autoImport: function (key, data) {
        if (data.n &#x26;&#x26; data.e) {
            if (data.d &#x26;&#x26; data.p &#x26;&#x26; data.q &#x26;&#x26; data.dmp1 &#x26;&#x26; data.dmq1 &#x26;&#x26; data.coeff
) {
                module.exports.privateImport(key, data);
                return true;
            } else {
                module.exports.<span class="apidocCodeKeywordSpan">publicImport</span>(key, data);
                return true;
            }
        }

        return false;
    }
};
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.node-rsa.pss" id="apidoc.module.node-rsa.pss">module node-rsa.pss</a></h1>






    <h2>
        <a href="#apidoc.element.node-rsa.pss.makeScheme" id="apidoc.element.node-rsa.pss.makeScheme">
        function <span class="apidocSignatureSpan">node-rsa.pss.</span>makeScheme
        <span class="apidocSignatureSpan">(key, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">makeScheme = function (key, options) {
    var OAEP = require(&#x27;./schemes&#x27;).pkcs1_oaep;

<span class="apidocCodeCommentSpan">    /**
     * @param key
     * @param options
     * options    [Object]    An object that contains the following keys that specify certain options for encoding.
     *  &#x3e;signingSchemeOptions
     *     &#x3e;hash    [String]    Hash function to use when encoding and generating masks. Must be a string accepted by node&#x27;s crypto
.createHash function. (default = &#x22;sha1&#x22;)
     *     &#x3e;mgf    [function]    The mask generation function to use when encoding. (default = mgf1SHA1)
     *     &#x3e;sLen    [uint]        The length of the salt to generate. (default = 20)
     * @constructor
     */
</span>    function Scheme(key, options) {
        this.key = key;
        this.options = options;
    }

    Scheme.prototype.sign = function (buffer) {
        var mHash = crypt.createHash(this.options.signingSchemeOptions.hash || DEFAULT_HASH_FUNCTION);
        mHash.update(buffer);

        var encoded = this.emsa_pss_encode(mHash.digest(), this.key.keySize - 1);
        return this.key.$doPrivate(new BigInteger(encoded)).toBuffer(this.key.encryptedDataLength);
    };

    Scheme.prototype.verify = function (buffer, signature, signature_encoding) {
        if (signature_encoding) {
            signature = new Buffer(signature, signature_encoding);
        }
        signature = new BigInteger(signature);

        var emLen = Math.ceil((this.key.keySize - 1) / 8);
        var m = this.key.$doPublic(signature).toBuffer(emLen);

        var mHash = crypt.createHash(this.options.signingSchemeOptions.hash || DEFAULT_HASH_FUNCTION);
        mHash.update(buffer);

        return this.emsa_pss_verify(mHash.digest(), m, this.key.keySize - 1);
    };

    /*
     * https://tools.ietf.org/html/rfc3447#section-9.1.1
     *
     * mHash	[Buffer]	Hashed message to encode
     * emBits	[uint]		Maximum length of output in bits. Must be at least 8hLen + 8sLen + 9 (hLen = Hash digest length in bytes |
sLen = length of salt in bytes)
     * @returns {Buffer} The encoded message
     */
    Scheme.prototype.emsa_pss_encode = function (mHash, emBits) {
        var hash = this.options.signingSchemeOptions.hash || DEFAULT_HASH_FUNCTION;
        var mgf = this.options.signingSchemeOptions.mgf || OAEP.eme_oaep_mgf1;
        var sLen = this.options.signingSchemeOptions.saltLength || DEFAULT_SALT_LENGTH;

        var hLen = OAEP.digestLength[hash];
        var emLen = Math.ceil(emBits / 8);

        if (emLen &#x3c; hLen + sLen + 2) {
            throw new Error(&#x22;Output length passed to emBits(&#x22; + emBits + &#x22;) is too small for the options &#x22; +
                &#x22;specified(&#x22; + hash + &#x22;, &#x22; + sLen + &#x22;). To fix this issue increase the value of emBits. (minimum size: &#x22; +
                (8 * hLen + 8 * sLen + 9) + &#x22;)&#x22;
            );
        }

        var salt = crypt.randomBytes(sLen);

        var Mapostrophe = new Buffer(8 + hLen + sLen);
        Mapostrophe.fill(0, 0, 8);
        mHash.copy(Mapostrophe, 8);
        salt.copy(Mapostrophe, 8 + mHash.length);

        var H = crypt.createHash(hash);
        H.update(Mapostrophe);
        H = H.digest();

        var PS = new Buffer(emLen - salt.length - hLen - 2);
        PS.fill(0);

        var DB = new Buffer(PS.length + 1 + salt.length);
        PS.copy(DB);
        DB[PS.length] = 0x01;
        salt.copy(DB, PS.length + 1);

        var dbMask = mgf(H, DB.length, hash);

        // XOR DB and dbMask together
        var maskedDB = new Buffer(DB.length);
        for (var i = 0; i &#x3c; dbMask.length; i++) {
            maskedDB[i] = DB[i] ^ dbMask[i];
        }

        var bits = 8 * emLen - emBits;
        var mask = 255 ^ (255 &#x3e;&#x3e; 8 - bits &#x3c;&#x3c; 8 - bits);
        maskedDB[0] = maskedDB[0] &#x26; mask;

        var EM = new Buffer(maskedDB.length + H.length + 1);
        maskedDB.copy(EM, 0);
        H.copy(EM, maskedDB.length);
        EM[EM.length - 1] = 0xbc;

        return EM;
    };

    /*
     * https://tools.ietf.org/html/rfc3447#section-9.1.2
     *
     * mHash	[Buffer]	Hashed message
     * EM		[Buffer]	Signature
     * emBits	[uint]		Length of EM in bits. ...</pre></li>
    <li>example usage<pre class="apidocCodePre">...


var crypto = require(&#x27;crypto&#x27;);
var constants = require(&#x27;constants&#x27;);
var schemes = require(&#x27;../schemes/schemes.js&#x27;);

module.exports = function (keyPair, options) {
var pkcs1Scheme = schemes.pkcs1.<span class="apidocCodeKeywordSpan">makeScheme</span>(keyPair, options);

return {
    encrypt: function (buffer, usePrivate) {
        if (usePrivate) {
            var padding = constants.RSA_PKCS1_PADDING;
            if (options.encryptionSchemeOptions &#x26;&#x26; options.encryptionSchemeOptions.padding) {
                padding = options.encryptionSchemeOptions.padding;
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.node-rsa.rsa" id="apidoc.module.node-rsa.rsa">module node-rsa.rsa</a></h1>


    <h2>
        <a href="#apidoc.element.node-rsa.rsa.BigInteger" id="apidoc.element.node-rsa.rsa.BigInteger">
        function <span class="apidocSignatureSpan">node-rsa.rsa.</span>BigInteger
        <span class="apidocSignatureSpan">(a, b)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function BigInteger(a, b) {
    if (a != null) {
        if (&#x22;number&#x22; == typeof a) {
            this.fromNumber(a, b);
        } else if (Buffer.isBuffer(a)) {
            this.fromBuffer(a);
        } else if (b == null &#x26;&#x26; &#x22;string&#x22; != typeof a) {
            this.fromByteArray(a);
        } else {
            this.fromString(a, b);
        }
    }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.node-rsa.rsa.Key" id="apidoc.element.node-rsa.rsa.Key">
        function <span class="apidocSignatureSpan">node-rsa.rsa.</span>Key
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function RSAKey() {
    this.n = null;
    this.e = 0;
    this.d = null;
    this.p = null;
    this.q = null;
    this.dmp1 = null;
    this.dmq1 = null;
    this.coeff = null;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    encryptionSchemeOptions: {
        hash: &#x27;sha1&#x27;,
        label: null
    },
    environment: utils.detectEnvironment(),
    rsaUtils: this
};
this.keyPair = new rsa.<span class="apidocCodeKeywordSpan">Key</span>();
this.$cache = {};

if (Buffer.isBuffer(key) || _.isString(key)) {
    this.importKey(key, format);
} else if (_.isObject(key)) {
    this.generateKeyPair(key.b, key.e);
}
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.node-rsa.schemes" id="apidoc.module.node-rsa.schemes">module node-rsa.schemes</a></h1>


    <h2>
        <a href="#apidoc.element.node-rsa.schemes.isEncryption" id="apidoc.element.node-rsa.schemes.isEncryption">
        function <span class="apidocSignatureSpan">node-rsa.schemes.</span>isEncryption
        <span class="apidocSignatureSpan">(scheme)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">isEncryption = function (scheme) {
    return module.exports[scheme] &#x26;&#x26; module.exports[scheme].isEncryption;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    this.$options.encryptionScheme = options.encryptionScheme.toLowerCase();
    this.$options.encryptionSchemeOptions = {};
} else if (_.isObject(options.encryptionScheme)) {
    this.$options.encryptionScheme = options.encryptionScheme.scheme || DEFAULT_ENCRYPTION_SCHEME;
    this.$options.encryptionSchemeOptions = _.omit(options.encryptionScheme, &#x27;scheme&#x27;);
}

if (!schemes.<span class="apidocCodeKeywordSpan">isEncryption</span>(this.$options.encryptionScheme)) {
    throw Error(&#x27;Unsupported encryption scheme&#x27;);
}

if (this.$options.encryptionSchemeOptions.hash &#x26;&#x26;
    SUPPORTED_HASH_ALGORITHMS[this.$options.environment].indexOf(this.$options.encryptionSchemeOptions.hash) === -1) {
    throw Error(&#x27;Unsupported hashing algorithm for &#x27; + this.$options.environment + &#x27; environment&#x27;);
}
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.node-rsa.schemes.isSignature" id="apidoc.element.node-rsa.schemes.isSignature">
        function <span class="apidocSignatureSpan">node-rsa.schemes.</span>isSignature
        <span class="apidocSignatureSpan">(scheme)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">isSignature = function (scheme) {
    return module.exports[scheme] &#x26;&#x26; module.exports[scheme].isSignature;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
        this.$options.signingScheme = signingScheme[0];
    }
} else if (_.isObject(options.signingScheme)) {
    this.$options.signingScheme = options.signingScheme.scheme || DEFAULT_SIGNING_SCHEME;
    this.$options.signingSchemeOptions = _.omit(options.signingScheme, &#x27;scheme&#x27;);
}

if (!schemes.<span class="apidocCodeKeywordSpan">isSignature</span>(this.$options.signingScheme)) {
    throw Error(&#x27;Unsupported signing scheme&#x27;);
}

if (this.$options.signingSchemeOptions.hash &#x26;&#x26;
    SUPPORTED_HASH_ALGORITHMS[this.$options.environment].indexOf(this.$options.signingSchemeOptions.hash) === -1) {
    throw Error(&#x27;Unsupported hashing algorithm for &#x27; + this.$options.environment + &#x27; environment&#x27;);
}
...</pre></li>
    </ul>








</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.node-rsa.utils" id="apidoc.module.node-rsa.utils">module node-rsa.utils</a></h1>


    <h2>
        <a href="#apidoc.element.node-rsa.utils.detectEnvironment" id="apidoc.element.node-rsa.utils.detectEnvironment">
        function <span class="apidocSignatureSpan">node-rsa.utils.</span>detectEnvironment
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">detectEnvironment = function () {
    if (process &#x26;&#x26; process.title === &#x27;browser&#x27; || (typeof(window) !== &#x27;undefined&#x27; &#x26;&#x26; window)) {
        return &#x27;browser&#x27;;
    }

    return &#x27;node&#x27;;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
        saltLength: null
    },
    encryptionScheme: DEFAULT_ENCRYPTION_SCHEME,
    encryptionSchemeOptions: {
        hash: &#x27;sha1&#x27;,
        label: null
    },
    environment: utils.<span class="apidocCodeKeywordSpan">detectEnvironment</span>(),
    rsaUtils: this
};
this.keyPair = new rsa.Key();
this.$cache = {};

if (Buffer.isBuffer(key) || _.isString(key)) {
    this.importKey(key, format);
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.node-rsa.utils.get32IntFromBuffer" id="apidoc.element.node-rsa.utils.get32IntFromBuffer">
        function <span class="apidocSignatureSpan">node-rsa.utils.</span>get32IntFromBuffer
        <span class="apidocSignatureSpan">(buffer, offset)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">get32IntFromBuffer = function (buffer, offset) {
    offset = offset || 0;
    var size = 0;
    if ((size = buffer.length - offset) &#x3e; 0) {
        if (size &#x3e;= 4) {
            return buffer.readUInt32BE(offset);
        } else {
            var res = 0;
            for (var i = offset + size, d = 0; i &#x3e; offset; i--, d += 2) {
                res += buffer[i - 1] * Math.pow(16, d);
            }
            return res;
        }
    } else {
        return NaN;
    }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
     * @param DP
     * @param DQ
     * @param C
     */
    RSAKey.prototype.setPrivate = function (N, E, D, P, Q, DP, DQ, C) {
        if (N &#x26;&#x26; E &#x26;&#x26; D &#x26;&#x26; N.length &#x3e; 0 &#x26;&#x26; (_.isNumber(E) || E.length &#x3e; 0) &#x26
;&#x26; D.length &#x3e; 0) {
this.n = new BigInteger(N);
this.e = _.isNumber(E) ? E : utils.<span class="apidocCodeKeywordSpan">get32IntFromBuffer</span>(E, 0);
this.d = new BigInteger(D);

if (P &#x26;&#x26; Q &#x26;&#x26; DP &#x26;&#x26; DQ &#x26;&#x26; C) {
    this.p = new BigInteger(P);
    this.q = new BigInteger(Q);
    this.dmp1 = new BigInteger(DP);
    this.dmq1 = new BigInteger(DQ);
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.node-rsa.utils.linebrk" id="apidoc.element.node-rsa.utils.linebrk">
        function <span class="apidocSignatureSpan">node-rsa.utils.</span>linebrk
        <span class="apidocSignatureSpan">(str, maxLen)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">linebrk = function (str, maxLen) {
    var res = &#x27;&#x27;;
    var i = 0;
    while (i + maxLen &#x3c; str.length) {
        res += str.substring(i, i + maxLen) + &#x22;\n&#x22;;
        i += maxLen;
    }
    return res + str.substring(i, str.length);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    writer.writeBuffer(dmq1, 2);
    writer.writeBuffer(coeff, 2);
    writer.endSequence();

    if (options.type === &#x27;der&#x27;) {
        return writer.buffer;
    } else {
        return &#x27;-----BEGIN RSA PRIVATE KEY-----\n&#x27; + utils.<span class="apidocCodeKeywordSpan">linebrk</span>(writer.buffer
.toString(&#x27;base64&#x27;), 64) + &#x27;\n-----END RSA PRIVATE KEY-----&#x27;;
    }
},

privateImport: function (key, data, options) {
    options = options || {};
    var buffer;
...</pre></li>
    </ul>




</div>

<div class="apidocFooterDiv">
    [ this document was created with
    <a href="https://github.com/kaizhu256/node-utility2" target="_blank">utility2</a>
    ]
</div>
</div>
